import{_ as Le,W as Fe,q as Ne,Z as Be,e as Me,r as _,c as J,E as Oe,s as Ue,I as se,h as d,j as S,i as t,z as Pe,J as qe,K as je,C as p,t as r,y as ce,n as I,w as Y,k as ne,F as G,l as X,v as ve,G as K,A as Ve,o as u}from"./index-CvQC7wJ-.js";const ze={class:"min-h-screen bg-gray-50"},We={key:0,class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-4"},He={class:"bg-white shadow-sm border-b border-gray-200 rounded-2xl"},Je={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},Ye={class:"flex items-center justify-between"},Ge={class:"text-gray-600 mt-1"},Xe={key:0,class:"text-indigo-600 font-medium"},Ke={key:1,class:"text-indigo-600 font-medium"},Ze={class:"flex items-center space-x-4"},Qe={class:"bg-indigo-50 px-4 py-2 rounded-lg border border-indigo-200"},et={class:"text-indigo-800 font-medium"},tt={class:"text-indigo-600 text-sm ml-2"},ot={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},st={key:2,class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-4"},nt={class:"bg-red-50 border border-red-200 rounded-md p-4"},at={class:"flex"},lt={class:"ml-3"},rt={class:"mt-1 text-sm text-red-700"},it={key:3,class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-4"},dt={class:"bg-yellow-50 border border-yellow-200 rounded-md p-4 text-sm"},ut={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},ct={class:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden mb-8"},vt={class:"p-6"},gt={class:"flex space-x-4 flex-wrap gap-2"},mt={class:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden mb-8"},pt={class:"p-6 border-b border-gray-200"},ft={class:"text-xl font-bold text-gray-900"},yt={class:"text-gray-600 mt-1"},bt={class:"p-6"},ht={class:"mb-6"},wt={class:"flex items-center justify-between mb-2"},xt=["disabled"],_t={class:"relative"},St=["disabled"],kt=["value"],Tt={key:0,class:"text-gray-500"},Dt={key:0,class:"mt-2 text-sm text-amber-600 bg-amber-50 border border-amber-200 rounded-md p-2"},At={key:1,class:"mt-2 text-sm text-green-600"},$t={key:0},Ct={key:0},It={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},Rt={class:"flex flex-wrap gap-2"},Et=["onClick"],Lt={key:1},Ft={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},Nt={class:"flex flex-wrap gap-2"},Bt=["onClick"],Mt={key:0},Ot={class:"relative"},Ut={key:1},Pt={class:"bg-gray-50 border border-gray-200 rounded-md px-3 py-2"},qt={class:"text-gray-700"},jt={key:2},Vt={key:3,class:"mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg"},zt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Wt={class:"border-t border-gray-200 pt-6"},Ht={class:"flex flex-col md:flex-row md:items-center md:justify-between"},Jt={class:"flex items-center space-x-3"},Yt={class:"relative"},Gt=["value"],Xt=["disabled"],Kt={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},Zt={key:1,class:"mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Qt={class:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden"},eo={class:"p-6"},to={class:"flex flex-wrap gap-2"},oo={class:"inline-flex items-center px-3 py-1.5 rounded-full text-sm bg-indigo-100 text-indigo-800"},so={class:"inline-flex items-center px-3 py-1.5 rounded-full text-sm bg-indigo-100 text-indigo-800"},no={class:"font-medium mr-1"},ao={key:0},lo={key:1},ro={class:"inline-flex items-center px-3 py-1.5 rounded-full text-sm bg-indigo-100 text-indigo-800"},io={class:"inline-flex items-center px-3 py-1.5 rounded-full text-sm bg-indigo-100 text-indigo-800"},uo={key:0},co={class:"inline-flex items-center px-3 py-1.5 rounded-full text-sm bg-indigo-100 text-indigo-800"},vo={class:"inline-flex items-center px-3 py-1.5 rounded-full text-sm bg-indigo-100 text-indigo-800"},go={__name:"BirthdaysReport",setup(mo,{expose:ge}){const b=Oe();Ve();const U=Fe(),N=Ne(),R=Be(),{showToast:E}=Me(),v=_("birthdays"),m=_("all"),L=_("monthly"),B=_("pdf"),me=_(!1),pe=()=>{const o=new Date;return{start:new Date(o.getTime()-720*60*60*1e3).toISOString().split("T")[0],end:o.toISOString().split("T")[0]}},{start:fe,end:ye}=pe(),k=_(fe),T=_(ye),$=_("all"),C=_(!1),h=_(null),P=_([]),M=_(!1),Z=o=>{if(!o)return!1;const e=String(o).trim();if(e.includes("0000-01-01")||e.includes("0001-01-01")||e.startsWith("0000-")||e.startsWith("0001-"))return!1;try{const s=new Date(e);return!isNaN(s.getTime())&&s.getFullYear()>1900}catch{return!1}},be=o=>{if(!o)return"";const e=String(o).trim();if(e.includes("0000-01-01")||e.includes("0001-01-01")||e.startsWith("0000-")||e.startsWith("0001-"))return"";try{let s,a;if(e.includes("T")||e.includes(" ")&&e.includes("-")){if(!Z(e))return"";const i=new Date(e);if(isNaN(i.getTime())||i.getFullYear()<1900)return"";s=i.getHours(),a=i.getMinutes()}else if(e.includes(":")){const i=e.split(":");s=parseInt(i[0],10),a=parseInt(i[1],10)}else return"";if(isNaN(s)||isNaN(a)||s<0||s>23||a<0||a>59)return"";const n=s>=12?"PM":"AM",l=s%12||12,D=a.toString().padStart(2,"0");return`${l}:${D} ${n}`}catch{return""}},he=o=>{if(!o)return"";const e=String(o).trim();if(e.includes("0000-01-01")||e.includes("0001-01-01")||e.startsWith("0000-")||e.startsWith("0001-"))return"";try{if(!Z(e))return"";const s=new Date(e);return isNaN(s.getTime())||s.getFullYear()<1900?"":s.toLocaleString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch{return""}},Q=[{label:"Weekly",value:"weekly"},{label:"Monthly",value:"monthly"},{label:"Yearly",value:"yearly"},{label:"Custom Range",value:"custom"}],ae=[{label:"PDF",value:"pdf"},{label:"CSV",value:"csv"},{label:"Excel",value:"excel"}],we=J(()=>{var n;const o=(N==null?void 0:N.user)||{},e=(o.role||o.userType||"").toString().toLowerCase(),s=Array.isArray(o.roles)?o.roles.map(l=>(l||"").toString().toLowerCase()):[],a=!!(o.isSuperAdmin||o.is_super_admin);return e==="superadmin"||s.includes("superadmin")||a||((n=b==null?void 0:b.query)==null?void 0:n.from)==="superadmin"}),y=J(()=>!!we.value),f=J(()=>{var o,e;if(y.value&&b.query.tenants){const s=String(b.query.tenants).split(",").filter(Boolean);if(s.length>1)return null;if(s.length===1)return s[0].trim()}return b.params.tenantId||b.query.tenantId||b.query.tenant_id||((o=N.user)==null?void 0:o.tenantId)||((e=N.user)==null?void 0:e.tenant_id)||(typeof localStorage<"u"?localStorage.getItem("current_tenant_id"):null)||null}),c=J(()=>{if(y.value&&b.query.tenants)return String(b.query.tenants).split(",").map(e=>e.trim()).filter(Boolean);const o=f.value;return o?[o]:[]}),A=J(()=>y.value&&c.value.length>1?P.value||[]:U.temples||[]),ee=o=>{if(o==="all")return"All Temples";const e=A.value.find(s=>{var a;return((a=s.id)==null?void 0:a.toString())===(o==null?void 0:o.toString())});return e?e.name:"Unknown Temple"},q=()=>{switch(v.value){case"birthdays":return"Devotee Birthdays";case"devotees":return"Devotee List";case"statusActive":return"Active Devotees";case"statusInactive":return"Inactive Devotees";case"profile":return"Devotee Profile";default:return"Report"}},xe=()=>{switch(v.value){case"birthdays":return"devotee birthday data";case"devotees":return"devotee list data";case"statusActive":return"active devotee data";case"statusInactive":return"inactive devotee data";case"profile":return"devotee profile data";default:return"report data"}},_e=()=>{switch(v.value){case"statusActive":return"Active Only";case"statusInactive":return"Inactive Only";case"devotees":return $.value==="all"?"All Statuses":$.value==="active"?"Active":$.value==="inactive"?"Inactive":$.value==="new"?"New Members":"All";default:return"All"}},Se=o=>{const e=Q.find(s=>s.value===o);return e?e.label:"Unknown"},te=o=>{const e=ae.find(s=>s.value===o);return e?e.label:"Unknown"},le=o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",oe=()=>{h.value=null},j=o=>{v.value=o,(o==="statusActive"||o==="statusInactive")&&($.value="all")},re=o=>{L.value=o;const e=new Date;if(o==="weekly"){const s=new Date(e.getTime()-6048e5);k.value=s.toISOString().split("T")[0],T.value=e.toISOString().split("T")[0]}else if(o==="monthly"){const s=new Date(e.getTime()-2592e6);k.value=s.toISOString().split("T")[0],T.value=e.toISOString().split("T")[0]}else if(o==="yearly"){const s=new Date(e.getFullYear()-1,e.getMonth(),e.getDate());k.value=s.toISOString().split("T")[0],T.value=e.toISOString().split("T")[0]}},ke=()=>{console.log("Temple changed to:",m.value),oe()},ie=()=>{k.value&&T.value&&new Date(k.value)>new Date(T.value)?h.value="Start date cannot be after end date":oe()},V=o=>o?{"X-Tenant-ID":String(o),"X-Entity-ID":String(o)}:{},Te=()=>{const o={dateRange:L.value,startDate:k.value,endDate:T.value,format:B.value,isSuperAdmin:y.value,reportType:v.value};if(v.value==="statusActive"?o.status="active":v.value==="statusInactive"?o.status="inactive":v.value==="devotees"&&$.value!=="all"&&(o.status=$.value),m.value!=="all"){const e=m.value,s=A.value.find(n=>String(n.id)===String(e));if(!s)throw console.error("Temple not found:",e),new Error("Selected temple not found");const a=s.tenant_id||s.created_by||s.entityId;if(!a)throw console.error("Temple has no tenant_id:",s),new Error("Temple has no associated tenant");o.entityId=e,o.tenantId=a,o.singleTemple=!0,console.log("âœ… Single temple params:",{templeId:e,tenantId:a,singleTemple:!0})}else y.value&&c.value.length>1?(o.tenantIds=c.value.slice(),o.entityIds=c.value.slice(),o.allTemples=!0):f.value&&(o.tenantId=f.value,o.entityId=f.value,o.allTemples=!0);return o},De=async()=>{var o,e;if(!M.value){if(!k.value||!T.value){h.value="Please select both start and end dates",E("Please select both start and end dates","error");return}if(new Date(k.value)>new Date(T.value)){h.value="Start date cannot be after end date",E("Start date cannot be after end date","error");return}if(c.value.length===0){h.value="No tenant selected for report generation",E("No tenant selected for report generation","error");return}if(m.value!=="all"&&!A.value.find(a=>String(a.id)===String(m.value))){h.value="Selected temple not found. Please refresh and try again.",E("Selected temple not found","error");return}M.value=!0,h.value=null;try{const s=Te();console.log("Downloading devotee report with params:",s);let a;if(R)try{switch(v.value){case"birthdays":if(typeof R.downloadDevoteeBirthdaysReport=="function")a=await R.downloadDevoteeBirthdaysReport(s);else throw new Error("Birthday report download method not available in store");break;case"devotees":case"statusActive":case"statusInactive":if(typeof R.downloadDevoteeListReport=="function")a=await R.downloadDevoteeListReport(s);else throw new Error("Devotee list report download method not available in store");break;case"profile":if(typeof R.downloadDevoteeProfileReport=="function")a=await R.downloadDevoteeProfileReport(s);else throw new Error("Devotee profile report download method not available in store");break;default:throw new Error("Unknown report type selected")}if(a&&a.success){const n=m.value==="all"?"all temples":ee(m.value);E(`${q()} for ${n} downloaded successfully as ${te(B.value)}`,"success")}else throw new Error((a==null?void 0:a.message)||"Failed to download report")}catch(n){console.warn("Store method failed, trying direct API call:",n);const l={"Content-Type":"application/json"};if(m.value!=="all"){const w=A.value.find(Ee=>String(Ee.id)===String(m.value)),H=(w==null?void 0:w.tenant_id)||(w==null?void 0:w.entityId)||(w==null?void 0:w.created_by)||f.value;H&&Object.assign(l,V(H))}else f.value&&c.value.length===1&&Object.assign(l,V(f.value));let D="",i=[];v.value==="birthdays"?i=["/v1/reports/devotees/birthdays/download","/reports/devotees/birthdays/download","/api/reports/devotees/birthdays","/v1/devotees/birthdays/report"]:["devotees","statusActive","statusInactive"].includes(v.value)?i=["/v1/reports/devotees/list/download","/reports/devotees/list/download","/api/reports/devotees/list","/v1/devotees/list/report"]:v.value==="profile"&&(i=["/v1/reports/devotees/profile/download","/reports/devotees/profile/download","/api/reports/devotees/profile","/v1/devotees/profile/report"]);let g=null,x=null;for(const w of i)try{if(console.log("Trying endpoint:",w),g=await K.post(w,s,{responseType:"blob",headers:l}),g&&g.data){D=w,console.log("Success with endpoint:",D);break}}catch(H){console.warn(`Endpoint ${w} failed:`,H.message),x=H}if(!g||!g.data)throw new Error(`All API endpoints failed. Last error: ${(x==null?void 0:x.message)||"Unknown error"}. Please contact support.`);const O=g.headers["content-type"]||"application/octet-stream",F=new Blob([g.data],{type:O}),ue=window.URL.createObjectURL(F),W=document.createElement("a");W.href=ue;const $e=new Date().toISOString().split("T")[0],Ce=q().toLowerCase().replace(/\s+/g,"-"),Ie=m.value==="all"?"all-temples":`temple-${m.value}`;W.download=`${Ce}-${Ie}-${$e}.${s.format}`,document.body.appendChild(W),W.click(),document.body.removeChild(W),window.URL.revokeObjectURL(ue);const Re=m.value==="all"?"all temples":ee(m.value);E(`${q()} for ${Re} downloaded successfully as ${te(B.value)}`,"success")}else throw new Error("Reports store is not available")}catch(s){console.error("Error downloading report:",s);const a=((e=(o=s.response)==null?void 0:o.data)==null?void 0:e.message)||s.message||"Unknown error occurred";h.value=`Failed to download report: ${a}`,E(`Failed to download report: ${a}`,"error")}finally{M.value=!1}}},z=async()=>{var o,e,s;C.value=!0,h.value=null;try{if(U.temples=[],P.value=[],c.value.length===0){console.warn("No tenant IDs available for fetching temples"),h.value="No tenant selected to load temples.";return}if(console.log("=== Starting Temple Fetch ==="),console.log("Tenant IDs to fetch:",c.value),console.log("Is Multi-tenant:",y.value&&c.value.length>1),y.value&&c.value.length>1){console.log(`Fetching temples for ${c.value.length} tenants:`,c.value);const a=c.value.map(i=>(console.log(`Creating request for tenant: ${i}`),de(i).catch(g=>(console.error(`Failed to fetch temples for tenant ${i}:`,g),[]))));console.log(`Executing ${a.length} parallel requests...`);const n=await Promise.allSettled(a);console.log("Results from Promise.allSettled:",n);const l=[];for(let i=0;i<n.length;i++){const g=n[i],x=c.value[i];g.status==="fulfilled"?(console.log(`Tenant ${x}: ${((o=g.value)==null?void 0:o.length)||0} temples`),Array.isArray(g.value)&&g.value.length>0&&l.push(...g.value)):console.error(`Tenant ${x}: Request failed`,g.reason)}console.log(`Total temples aggregated: ${l.length}`);const D=new Set;P.value=l.filter(i=>D.has(i.id)?(console.log(`Duplicate temple found: ${i.id} - ${i.name}`),!1):(D.add(i.id),!0)),console.log(`After deduplication: ${P.value.length} unique temples`),console.log("Temple details:",P.value.map(i=>({id:i.id,name:i.name,tenant:i.tenant_id})))}else if(f.value){console.log("Fetching temples for single tenant:",f.value);const a=await de(f.value);U.temples=a,console.log(`Loaded ${U.temples.length} temples for tenant ${f.value}`),console.log("Temple details:",U.temples.map(n=>({id:n.id,name:n.name,tenant:n.tenant_id})))}else console.warn("No tenant ID available to fetch temples"),h.value="No tenant selected to load temples.";console.log("=== Temple Fetch Complete ===")}catch(a){console.error("Error in fetchTemples:",a);const n=((s=(e=a.response)==null?void 0:e.data)==null?void 0:s.message)||a.message||"Unknown error occurred";h.value=`Failed to load temple data: ${n}`}finally{C.value=!1}},de=async o=>{console.log(`Fetching temples for tenant: ${o}`);try{let e=[];try{console.log(`Strategy 1: Trying /v1/temples for tenant ${o}`);const s=await K.get("/v1/temples",{params:{tenant_id:o,entityId:o,entity_id:o},headers:V(o)});let a=[];if(Array.isArray(s.data)?a=s.data:s.data&&Array.isArray(s.data.data)?a=s.data.data:s.data&&Array.isArray(s.data.temples)&&(a=s.data.temples),console.log(`Found ${a.length} temples from /v1/temples for tenant ${o}`),a.length>0)return e=a.map(n=>({id:n.id,name:n.name||n.temple_name||n.entity_name||"Unknown Temple",status:n.status||"active",tenant_id:n.tenant_id||n.entityId||n.created_by||o,created_by:n.created_by||o,entityId:n.entityId||n.tenant_id||o})),e}catch(s){console.log(`Strategy 1 failed for tenant ${o}:`,s.message)}try{console.log(`Strategy 2: Trying /entities for tenant ${o}`);const s=await K.get("/entities",{params:{tenant_id:o,entityId:o,entity_id:o,created_by:o},headers:V(o)});let a=[];Array.isArray(s.data)?a=s.data:s.data&&Array.isArray(s.data.data)?a=s.data.data:s.data&&Array.isArray(s.data.entities)&&(a=s.data.entities),console.log(`Got ${a.length} total entities from /entities`);const n=a.filter(l=>{const D=String(l.created_by||""),i=String(l.tenant_id||""),g=String(l.entityId||""),x=String(o),O=D===x||i===x||g===x;return O&&console.log(`Entity ${l.id} (${l.name}) belongs to tenant ${o}`),O});if(console.log(`Filtered ${n.length} entities for tenant ${o}`),n.length>0)return e=n.map(l=>({id:l.id,name:l.name||l.temple_name||l.entity_name||"Unknown Temple",status:l.status||"active",tenant_id:l.tenant_id||l.entityId||l.created_by||o,created_by:l.created_by||o,entityId:l.entityId||l.tenant_id||o})),e}catch(s){console.log(`Strategy 2 failed for tenant ${o}:`,s.message)}try{console.log(`Strategy 3: Trying /entities without filters for tenant ${o}`);const s=await K.get("/entities",{headers:V(o)});let a=[];Array.isArray(s.data)?a=s.data:s.data&&Array.isArray(s.data.data)&&(a=s.data.data),console.log(`Got ${a.length} total entities from /entities (no filter)`);const n=a.filter(l=>{const D=String(l.created_by||""),i=String(l.tenant_id||""),g=String(l.entityId||""),x=String(l.owner_id||""),O=String(l.user_id||""),F=String(o);return D===F||i===F||g===F||x===F||O===F});if(console.log(`Client-side filtered ${n.length} entities for tenant ${o}`),n.length>0)return e=n.map(l=>({id:l.id,name:l.name||l.temple_name||l.entity_name||"Unknown Temple",status:l.status||"active",tenant_id:l.tenant_id||l.entityId||l.created_by||o,created_by:l.created_by||o,entityId:l.entityId||l.tenant_id||o})),e}catch(s){console.error(`Strategy 3 failed for tenant ${o}:`,s)}return console.warn(`All strategies failed for tenant ${o}, returning empty array`),[]}catch(e){return console.error(`Error fetching temples for tenant ${o}:`,e),[]}},Ae=async()=>{await z()};return Ue(async()=>{console.log("Component mounted with tenant context:",{fromSuperadmin:y.value,effectiveTenantId:f.value,tenantIds:c.value,routeQuery:b.query,routeParams:b.params}),await z()}),se(c,async(o,e)=>{o&&o.length>0&&JSON.stringify(o)!==JSON.stringify(e)&&(console.log("Tenant IDs changed, refetching temples:",{old:e,new:o}),await z())},{deep:!0}),se(f,async(o,e)=>{o!==e&&(console.log("Effective tenant ID changed, refetching temples:",{old:e,new:o}),await z())}),se(()=>b.query,async(o,e)=>{(o.tenants!==e.tenants||o.tenantId!==e.tenantId)&&(console.log("Route query changed, updating tenant context:",{old:e,new:o}),await z())},{deep:!0}),ge({formatTime12Hour:be,formatDateTime:he,isValidDate:Z}),(o,e)=>{var a;const s=je("router-link");return u(),d("div",ze,[y.value?(u(),d("div",We,[Pe(s,{to:"/superadmin/reports",class:"inline-flex items-center px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"},{default:qe(()=>[...e[10]||(e[10]=[t("svg",{class:"mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),p(" Back to SuperAdmin Reports ",-1)])]),_:1})])):S("",!0),t("div",He,[t("div",Je,[t("div",Ye,[t("div",null,[e[12]||(e[12]=t("h1",{class:"text-2xl font-bold text-gray-900"},"Devotee Reports",-1)),t("p",Ge,[e[11]||(e[11]=p(" Download devotee data for your temples ",-1)),y.value&&c.value.length>1?(u(),d("span",Xe," (Multiple Tenants: "+r(c.value.length)+" selected) ",1)):f.value?(u(),d("span",Ke," (Tenant ID: "+r(f.value)+") ",1)):S("",!0)])]),t("div",Ze,[t("div",Qe,[t("span",et,r(((a=ce(N).user)==null?void 0:a.name)||"Tenant User"),1),t("span",tt,r(y.value?"(Super Admin)":"(Tenant)"),1)])])])])]),C.value?(u(),d("div",ot,[...e[13]||(e[13]=[t("div",{class:"bg-white rounded-lg p-6 flex items-center space-x-3"},[t("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-indigo-600"}),t("span",{class:"text-gray-900 font-medium"},"Loading data...")],-1)])])):S("",!0),h.value?(u(),d("div",st,[t("div",nt,[t("div",at,[e[16]||(e[16]=t("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),t("div",lt,[e[14]||(e[14]=t("h3",{class:"text-sm font-medium text-red-800"},"Error",-1)),t("p",rt,r(h.value),1)]),t("div",{class:"ml-auto pl-3"},[t("button",{onClick:oe,class:"text-red-400 hover:text-red-500"},[...e[15]||(e[15]=[t("span",{class:"sr-only"},"Dismiss",-1),t("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])])])])])])):S("",!0),me.value?(u(),d("div",it,[t("div",dt,[e[23]||(e[23]=t("h4",{class:"font-medium text-yellow-800"},"Debug Info:",-1)),t("p",null,[e[17]||(e[17]=t("strong",null,"From Superadmin:",-1)),p(" "+r(y.value),1)]),t("p",null,[e[18]||(e[18]=t("strong",null,"Effective Tenant ID:",-1)),p(" "+r(f.value),1)]),t("p",null,[e[19]||(e[19]=t("strong",null,"Tenant IDs:",-1)),p(" "+r(JSON.stringify(c.value)),1)]),t("p",null,[e[20]||(e[20]=t("strong",null,"Selected Temple:",-1)),p(" "+r(m.value),1)]),t("p",null,[e[21]||(e[21]=t("strong",null,"Available Temples:",-1)),p(" "+r(A.value.length),1)]),t("p",null,[e[22]||(e[22]=t("strong",null,"Route Query:",-1)),p(" "+r(JSON.stringify(ce(b).query)),1)])])])):S("",!0),t("div",ut,[t("div",ct,[t("div",vt,[e[24]||(e[24]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Select Report Type",-1)),t("div",gt,[t("button",{onClick:e[0]||(e[0]=n=>j("birthdays")),class:I(["px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200",v.value==="birthdays"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])}," Devotee Birthdays ",2),t("button",{onClick:e[1]||(e[1]=n=>j("devotees")),class:I(["px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200",v.value==="devotees"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])}," Devotee List ",2),t("button",{onClick:e[2]||(e[2]=n=>j("statusActive")),class:I(["px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200",v.value==="statusActive"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])}," Active Devotees ",2),t("button",{onClick:e[3]||(e[3]=n=>j("statusInactive")),class:I(["px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200",v.value==="statusInactive"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])}," Inactive Devotees ",2),t("button",{onClick:e[4]||(e[4]=n=>j("profile")),class:I(["px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200",v.value==="profile"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])}," Devotee Profile ",2)])])]),t("div",mt,[t("div",pt,[t("h3",ft,r(q()),1),t("p",yt," Configure filters and download "+r(xe()),1)]),t("div",bt,[t("div",ht,[t("div",wt,[e[26]||(e[26]=t("label",{class:"block text-gray-700 font-medium"},"Select Temple",-1)),t("button",{onClick:Ae,disabled:C.value,class:"inline-flex items-center px-3 py-1.5 text-xs font-medium text-indigo-600 bg-indigo-50 border border-indigo-200 rounded-md hover:bg-indigo-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed"},[(u(),d("svg",{class:I(["mr-1 h-3 w-3",{"animate-spin":C.value}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...e[25]||(e[25]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2)),p(" "+r(C.value?"Refreshing...":"Refresh"),1)],8,xt)]),t("div",_t,[Y(t("select",{"onUpdate:modelValue":e[5]||(e[5]=n=>m.value=n),class:"block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",onChange:ke,disabled:C.value},[e[27]||(e[27]=t("option",{value:"all"},"All Temples",-1)),(u(!0),d(G,null,X(A.value,n=>(u(),d("option",{key:n.id,value:n.id},[p(r(n.name)+" ",1),n.tenant_id?(u(),d("span",Tt,"(Tenant: "+r(n.tenant_id)+")",1)):S("",!0)],8,kt))),128))],40,St),[[ne,m.value]])]),A.value.length===0&&!C.value?(u(),d("div",Dt,[...e[28]||(e[28]=[t("div",{class:"flex items-center"},[t("svg",{class:"h-4 w-4 text-amber-500 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})]),p(" No temples found for selected tenant(s). Please check tenant access or try refreshing. ")],-1)])])):A.value.length>0?(u(),d("div",At,[p(r(A.value.length)+" temple"+r(A.value.length!==1?"s":"")+" available ",1),y.value&&c.value.length>1?(u(),d("span",$t," across "+r(c.value.length)+" tenant"+r(c.value.length!==1?"s":""),1)):S("",!0)])):S("",!0)]),v.value==="birthdays"?(u(),d("div",Ct,[t("div",It,[t("div",null,[e[29]||(e[29]=t("label",{class:"block text-gray-700 font-medium mb-2"},"Birthday Period",-1)),t("div",Rt,[(u(),d(G,null,X(Q,n=>t("button",{key:n.value,onClick:l=>re(n.value),class:I(["px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200",L.value===n.value?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},r(n.label),11,Et)),64))])])])])):["devotees","statusActive","statusInactive"].includes(v.value)?(u(),d("div",Lt,[t("div",Ft,[t("div",null,[e[30]||(e[30]=t("label",{class:"block text-gray-700 font-medium mb-2"},"Join Date Period",-1)),t("div",Nt,[(u(),d(G,null,X(Q,n=>t("button",{key:n.value,onClick:l=>re(n.value),class:I(["px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200",L.value===n.value?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},r(n.label),11,Bt)),64))])]),v.value==="devotees"?(u(),d("div",Mt,[e[32]||(e[32]=t("label",{class:"block text-gray-700 font-medium mb-2"},"Devotee Status",-1)),t("div",Ot,[Y(t("select",{"onUpdate:modelValue":e[6]||(e[6]=n=>$.value=n),class:"block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"},[...e[31]||(e[31]=[t("option",{value:"all"},"All Statuses",-1),t("option",{value:"active"},"Active",-1),t("option",{value:"inactive"},"Inactive",-1),t("option",{value:"new"},"New Members",-1)])],512),[[ne,$.value]])])])):v.value==="statusActive"||v.value==="statusInactive"?(u(),d("div",Ut,[e[33]||(e[33]=t("label",{class:"block text-gray-700 font-medium mb-2"},"Status Filter",-1)),t("div",Pt,[t("span",qt,r(v.value==="statusActive"?"Active Devotees Only":"Inactive Devotees Only"),1)])])):S("",!0)])])):v.value==="profile"?(u(),d("div",jt,[...e[34]||(e[34]=[t("p",{class:"text-gray-600 mb-6"},"This report includes detailed profile information for devotees.",-1)])])):S("",!0),L.value==="custom"?(u(),d("div",Vt,[t("div",zt,[t("div",null,[e[35]||(e[35]=t("label",{class:"block text-gray-700 text-sm font-medium mb-2"},"Start Date",-1)),Y(t("input",{type:"date","onUpdate:modelValue":e[7]||(e[7]=n=>k.value=n),class:"w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",onChange:ie},null,544),[[ve,k.value]])]),t("div",null,[e[36]||(e[36]=t("label",{class:"block text-gray-700 text-sm font-medium mb-2"},"End Date",-1)),Y(t("input",{type:"date","onUpdate:modelValue":e[8]||(e[8]=n=>T.value=n),class:"w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",onChange:ie},null,544),[[ve,T.value]])])])])):S("",!0),t("div",Wt,[t("div",Ht,[e[39]||(e[39]=t("div",{class:"mb-4 md:mb-0"},[t("h4",{class:"text-lg font-medium text-gray-900"},"Download Report"),t("p",{class:"text-sm text-gray-600"},"Select a format and click download")],-1)),t("div",Jt,[t("div",Yt,[Y(t("select",{"onUpdate:modelValue":e[9]||(e[9]=n=>B.value=n),class:"block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"},[(u(),d(G,null,X(ae,n=>t("option",{key:n.value,value:n.value},r(n.label),9,Gt)),64))],512),[[ne,B.value]])]),t("button",{onClick:De,disabled:M.value,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed"},[M.value?(u(),d("svg",Kt,[...e[37]||(e[37]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(u(),d("svg",Zt,[...e[38]||(e[38]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"},null,-1)])])),p(" "+r(M.value?"Downloading...":"Download"),1)],8,Xt)])])])])]),t("div",Qt,[t("div",eo,[e[45]||(e[45]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Applied Filters",-1)),t("div",to,[t("div",oo,[e[40]||(e[40]=t("span",{class:"font-medium mr-1"},"Report Type:",-1)),p(" "+r(q()),1)]),t("div",so,[t("span",no,r(y.value&&c.value.length>1?"Tenants:":"Tenant:"),1),y.value&&c.value.length>1?(u(),d("span",ao,r(c.value.length)+" selected ",1)):(u(),d("span",lo,r(f.value),1))]),t("div",ro,[e[41]||(e[41]=t("span",{class:"font-medium mr-1"},"Temple:",-1)),p(" "+r(m.value==="all"?"All Temples":ee(m.value)),1)]),t("div",io,[e[42]||(e[42]=t("span",{class:"font-medium mr-1"},"Period:",-1)),p(" "+r(Se(L.value))+" ",1),L.value==="custom"?(u(),d("span",uo," ("+r(le(k.value))+" - "+r(le(T.value))+") ",1)):S("",!0)]),t("div",co,[e[43]||(e[43]=t("span",{class:"font-medium mr-1"},"Status:",-1)),p(" "+r(_e()),1)]),t("div",vo,[e[44]||(e[44]=t("span",{class:"font-medium mr-1"},"Format:",-1)),p(" "+r(te(B.value)),1)])]),e[46]||(e[46]=t("p",{class:"mt-4 text-sm text-gray-600"}," Your report will include data based on the filters above. Click Download to generate and download the report. ",-1))])])])])}}},fo=Le(go,[["__scopeId","data-v-5b6dbf99"]]);export{fo as default};
