import{_ as ne,h as o,j as u,o as r,e as Pe,c as D,r as w,s as Te,i as e,C as c,F as L,l as $,n as x,t as d,B as oe,p as I,w as U,v as P,z as re,O as Se,k as Ae,P as Be}from"./index-CSzH4brs.js";import{u as Ve}from"./superadmin-Cis_NI2G.js";import"./superadmin.service-BkJLvc6W.js";const je={name:"UserAssignButton",props:{user:{type:Object,required:!0}},computed:{shouldShowAssignButton(){if(!this.user||!this.user.role)return!1;let B="";return typeof this.user.role=="string"?B=this.user.role.toLowerCase():typeof this.user.role=="object"&&(B=(this.user.role.role_name||this.user.role.roleName||"").toLowerCase()),["standarduser","standard user","Standard User","monitoringuser","monitoring user","Monitor User"].includes(B)}},methods:{navigateToAssignPage(){this.$router.push({name:"AssignTenants",params:{userId:this.user.id||this.user.ID}})}}};function Me(B,A,T,k,H,S){return S.shouldShowAssignButton?(r(),o("button",{key:0,onClick:A[0]||(A[0]=(...J)=>S.navigateToAssignPage&&S.navigateToAssignPage(...J)),class:"text-indigo-600 hover:text-indigo-900 ml-2"}," Tenant Assigned / Assign ")):u("",!0)}const Fe=ne(je,[["render",Me]]),Le={class:"bg-white rounded-xl shadow-sm border border-gray-200"},$e={class:"px-6 pt-6"},qe={class:"flex space-x-2 border-b border-gray-200"},Ee=["onClick"],Re={class:"p-6"},ze={class:"overflow-x-auto"},Oe={class:"min-w-full divide-y divide-gray-200"},Ie={class:"bg-white divide-y divide-gray-200"},He={key:0,class:"animate-pulse"},Je={key:1},We={class:"px-6 py-4 whitespace-nowrap"},Ge={class:"text-sm font-medium text-gray-900"},Ke={class:"px-6 py-4 whitespace-nowrap"},Qe={class:"text-sm text-gray-500"},Xe={class:"px-6 py-4 whitespace-nowrap"},Ye={class:"text-sm text-gray-500"},Ze={class:"px-6 py-4 whitespace-nowrap"},et={class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-indigo-100 text-indigo-800"},tt={class:"px-6 py-4 whitespace-nowrap"},st={class:"relative inline-block w-10 mr-2 align-middle select-none"},lt=["id","checked","onChange"],at=["for"],ot={class:"text-xs ml-1"},rt={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},nt=["onClick"],it={key:0,class:"fixed inset-0 z-50 overflow-auto bg-black bg-opacity-50 flex items-center justify-center"},dt={class:"bg-white rounded-lg shadow-xl max-w-5xl w-full mx-4 max-h-[90vh] overflow-y-auto"},ut={class:"px-6 py-4"},pt={class:"flex items-start"},ct={class:"flex-shrink-0"},mt={key:0,class:"h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20"},vt={key:1,class:"h-5 w-5 text-red-500",fill:"currentColor",viewBox:"0 0 20 20"},gt={class:"ml-3 w-full"},ft={key:0},xt={key:0},bt={key:1},ht={key:2,class:"mt-2 list-disc list-inside"},yt={key:1,class:"space-y-6"},wt={class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},kt={class:"flex items-start"},_t={class:"mt-2 text-sm text-blue-700"},Ct={class:"list-disc list-inside mt-1 space-y-1"},Nt={class:"mt-6"},Ut={key:0,class:"mt-2 text-sm text-red-600"},Dt={key:2,class:"space-y-6"},Pt={class:"flex items-center justify-between"},Tt={class:"text-sm text-gray-600"},St={class:"overflow-x-auto border border-gray-200 rounded-lg"},At={class:"min-w-full divide-y divide-gray-200"},Bt={class:"bg-white divide-y divide-gray-200"},Vt={class:"px-4 py-3 text-sm text-gray-900"},jt={class:"px-4 py-3 text-sm text-gray-500"},Mt={class:"px-4 py-3 text-sm text-gray-500"},Ft={class:"px-4 py-3 text-sm text-gray-500"},Lt={class:"px-4 py-3 text-sm"},$t={class:"px-4 py-3 text-sm"},qt={class:"px-4 py-3 text-sm"},Et={key:0},Rt={key:0,class:"px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800"},zt={key:1,class:"px-2 py-1 text-xs rounded-full bg-red-100 text-red-800"},Ot={key:1,class:"text-xs text-gray-400"},It={key:0,class:"text-sm text-gray-500 text-center"},Ht={class:"flex justify-end space-x-3 pt-4 border-t border-gray-200"},Jt=["disabled"],Wt={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Gt={key:1,class:"fixed inset-0 z-50 overflow-auto bg-black bg-opacity-50 flex items-center justify-center"},Kt={class:"bg-white rounded-lg shadow-xl max-w-3xl w-full mx-4 max-h-[90vh] overflow-y-auto"},Qt={class:"px-6 py-4 border-b border-gray-200 flex justify-between items-center"},Xt={class:"text-lg font-medium text-gray-900"},Yt={class:"px-6 py-4"},Zt={key:0,class:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4"},es={class:"flex items-center"},ts={class:"ml-3"},ss={class:"text-sm font-medium text-green-800"},ls={class:"mt-1 text-sm text-green-700"},as={key:0,class:"mt-1 text-sm text-red-600"},os={key:0,class:"mt-1 text-sm text-red-600"},rs={key:0},ns={key:0,class:"mt-1 text-sm text-red-600"},is={key:0,class:"mt-1 text-sm text-red-600"},ds=["disabled"],us={value:"",disabled:""},ps=["value"],cs={key:0,class:"mt-2 text-sm text-amber-600"},ms={key:1,class:"mt-2 text-sm text-red-600"},vs={key:1,class:"space-y-4 p-4 bg-gray-50 rounded-lg border border-gray-200"},gs={key:0,class:"mt-1 text-sm text-red-600"},fs={key:0,class:"mt-1 text-sm text-red-600"},xs={key:0,class:"mt-1 text-sm text-red-600"},bs={key:0,class:"mt-1 text-sm text-red-600"},hs={key:0,class:"mt-1 text-sm text-red-600"},ys={key:2,class:"flex items-center space-x-2"},ws={class:"relative inline-block w-10 mr-2 align-middle select-none"},ks={class:"text-sm text-gray-500"},_s={class:"flex justify-end space-x-3 pt-3"},Cs=["disabled"],Ns={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Us={__name:"UserManagement",setup(B){const{success:A,error:T}=Pe(),k=Ve(),H=D(()=>k.loadingUserAction),S=D(()=>k.loadingUserRoles),J=D(()=>k.loadingUsers),V=w(!1),j=w(!1),h=w(!1),W=w(null),q=w("internal"),G=w(!1),_=w([]),y=w(""),E=w(!1),M=w(!1),m=w(null),R=D(()=>k.userRoles||[]),ie=D(()=>k.users||[]),Q=D(()=>R.value.map(s=>s.role_name)),de=[{value:"internal",label:"Internal Admins"},{value:"volunteers",label:"Volunteers"},{value:"devotees",label:"Devotees"}],F={internal:["superadmin","templeadmin","standarduser","monitoringuser"],volunteers:["volunteer","4"],devotees:["devotee","user","3"]},K=s=>{let t="";return typeof s=="object"&&s?t=s.role_name||s.name||s.description||"":t=s||"",String(t).toLowerCase().replace(/[\s\-_]/g,"")},ue=s=>K(s==null?void 0:s.role)==="templeadmin",pe=s=>{var b,g,O,ae;const t=f=>typeof f=="string"?f.toLowerCase().trim():null,i=f=>typeof f=="boolean"?f:null,p=[t((b=s==null?void 0:s.temple_details)==null?void 0:b.approval_status),t((g=s==null?void 0:s.temple_details)==null?void 0:g.approvalStatus),t((O=s==null?void 0:s.temple_details)==null?void 0:O.approval),t(s==null?void 0:s.approval_status),t(s==null?void 0:s.approvalStatus)].filter(Boolean);if([i((ae=s==null?void 0:s.temple_details)==null?void 0:ae.is_approved),i(s==null?void 0:s.is_approved)].filter(f=>f!==null).includes(!0))return{known:!0,approved:!0};if(p.some(f=>f==="approved"||f==="approve"||f.includes("approve")&&!f.includes("not")&&!f.includes("un")&&!f.includes("reject")&&!f.includes("pending")))return{known:!0,approved:!0};const l=["pending","under_review","underreview","awaiting_approval","awaitingapproval","not_approved","notapproved","rejected","declined"];return p.some(f=>l.includes(f))?{known:!0,approved:!1}:{known:!1,approved:!1}},X=s=>{var p;const t=K(s==null?void 0:s.role),i=String((s==null?void 0:s.role_id)||((p=s==null?void 0:s.role)==null?void 0:p.id)||"");return F.internal.includes(t)?"internal":F.volunteers.includes(t)||F.volunteers.includes(i)?"volunteers":F.devotees.includes(t)||F.devotees.includes(i)?"devotees":"other"},ce=s=>(Y.value??[]).filter(p=>X(p)===s).length||0,Y=D(()=>(ie.value||[]).filter(s=>{if(!ue(s))return!0;const t=pe(s);return t.known?t.approved:!0})),Z=D(()=>Y.value.filter(s=>X(s)===q.value)),a=w({fullName:"",email:"",password:"",phone:"",role:"",isActive:!0,templeDetails:{name:"",place:"",address:"",phoneNumber:"",description:""}}),n=w({}),me=()=>{j.value=!0},ve=()=>{G.value=!0,m.value=null},ge=()=>{G.value=!1,z(),m.value=null};Te(async()=>{await k.refreshUserData()});const fe=s=>{if(typeof s=="object"&&(s!=null&&s.description))return s.description;if(typeof s=="object"&&(s!=null&&s.role_name))return s.role_name;const t=R.value.find(i=>i.role_name===s);return t?t.description||t.role_name:s},ee=s=>{const t=K(s==null?void 0:s.role),i=t==="standarduser"||t==="monitoringuser",p=((s==null?void 0:s.status)||"").toLowerCase()!=="active";return i&&p},xe=s=>Q.value.includes(s),be=s=>["active","inactive"].includes(s==null?void 0:s.toLowerCase()),he=()=>{const t=[["Full Name","Email","Phone","Password","Role","Status","Temple Name","Temple Place","Temple Address","Temple Phone","Temple Description"],["John Doe","john.doe@example.com","+1234567890","password123","user","active","","","","",""],["Jane Smith","jane.smith@example.com","+1234567891","password456","admin","active","","","","",""],["Mike Johnson","mike.johnson@example.com","+1234567892","password789","templeadmin","active","Shiva Temple","New Delhi, Delhi","123 Temple Street, New Delhi","+919876543210","Ancient temple dedicated to Lord Shiva"]].map(N=>N.map(l=>`"${l}"`).join(",")).join(`
`),i=new Blob([t],{type:"text/csv;charset=utf-8;"}),p=document.createElement("a"),C=URL.createObjectURL(i);p.setAttribute("href",C),p.setAttribute("download","bulk_users_template.csv"),p.style.visibility="hidden",document.body.appendChild(p),p.click(),document.body.removeChild(p)},ye=s=>{const t=s.target.files[0];t&&te(t)},we=s=>{E.value=!1;const t=s.dataTransfer.files;t.length>0&&te(t[0])},te=s=>{if(y.value="",!s.name.toLowerCase().endsWith(".csv")){y.value="Please upload a CSV file (.csv extension required)";return}if(s.size>5*1024*1024){y.value="File size must be less than 5MB";return}const t=new FileReader;t.onload=i=>{try{const p=i.target.result;ke(p)}catch{y.value="Error reading the file. Please try again."}},t.onerror=()=>{y.value="Error reading the file. Please try again."},t.readAsText(s)},ke=s=>{try{const t=s.split(`
`).filter(v=>v.trim());if(t.length<2){y.value="CSV file must contain at least a header row and one data row";return}const i=t[0].split(",").map(v=>v.replace(/\"/g,"").trim()),p=["Full Name","Email","Phone","Password","Role","Status","Temple Name","Temple Place","Temple Address","Temple Phone","Temple Description"],C=["Full Name","Email","Phone","Password","Role","Status"],N=C.filter(v=>!i.includes(v));if(N.length>0){y.value=`Missing required CSV headers: ${N.join(", ")}`;return}const l=[];for(let v=1;v<t.length;v++){const b=t[v].split(",").map(O=>O.replace(/\"/g,"").trim());if(b.length<C.length){y.value=`Row ${v+1} has ${b.length} columns but expected at least ${C.length}`;return}const g={full_name:b[i.indexOf("Full Name")],email:b[i.indexOf("Email")],phone:b[i.indexOf("Phone")],password:b[i.indexOf("Password")],role:b[i.indexOf("Role")],status:b[i.indexOf("Status")]};if(i.includes("Temple Name")&&(g.temple_name=b[i.indexOf("Temple Name")]||""),i.includes("Temple Place")&&(g.temple_place=b[i.indexOf("Temple Place")]||""),i.includes("Temple Address")&&(g.temple_address=b[i.indexOf("Temple Address")]||""),i.includes("Temple Phone")&&(g.temple_phone=b[i.indexOf("Temple Phone")]||""),i.includes("Temple Description")&&(g.temple_description=b[i.indexOf("Temple Description")]||""),!g.full_name||!g.email||!g.phone||!g.password||!g.role){y.value=`Row ${v+1} is missing required fields (Full Name, Email, Phone, Password, or Role)`;return}if(g.role.toLowerCase()==="templeadmin"&&(!g.temple_name||!g.temple_place||!g.temple_address||!g.temple_phone||!g.temple_description)){y.value=`Row ${v+1}: Temple Admin role requires all temple details (Temple Name, Temple Place, Temple Address, Temple Phone, Temple Description)`;return}l.push(g)}_.value=l}catch{y.value="Error parsing CSV file. Please check the format and try again."}},z=()=>{_.value=[],y.value="",window.document.querySelector('input[type="file"]')&&(window.document.querySelector('input[type="file"]').value="")},_e=async()=>{if(!_.value.length){T("No CSV data to upload");return}M.value=!0,m.value=null;try{const s=await k.createBulkUsers(_.value);s.success?(m.value={success:!0,message:"Bulk upload completed successfully",data:s.data},A(`Successfully uploaded ${s.data.success_count} out of ${s.data.total_rows} users`),await k.refreshUserData(),setTimeout(()=>{z()},3e3)):(m.value={success:!1,message:s.error||"Bulk upload failed",data:s.data},T(s.error||"Failed to upload users"))}catch{m.value={success:!1,message:"An error occurred during bulk upload",data:null},T("Failed to upload users. Please try again.")}finally{M.value=!1}};D(()=>!a.value.fullName||!a.value.email||!h.value&&!a.value.password||!a.value.phone||!a.value.role||a.value.role==="templeadmin"&&(!a.value.templeDetails.name||!a.value.templeDetails.place||!a.value.templeDetails.address||!a.value.templeDetails.phoneNumber||!a.value.templeDetails.description)?!1:Object.keys(n.value).length===0);const Ce=()=>{var s;return n.value={},a.value.fullName.trim()?a.value.fullName.trim().length<2&&(n.value.fullName="Full name must be at least 2 characters"):n.value.fullName="Full name is required",a.value.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.value.email)||(n.value.email="Please enter a valid email address"):n.value.email="Email is required",h.value||(a.value.password?a.value.password.length<6&&(n.value.password="Password must be at least 6 characters"):n.value.password="Password is required"),a.value.phone?/^[\+]?[1-9][\d]{0,15}$/.test(a.value.phone.replace(/\s/g,""))||(n.value.phone="Please enter a valid phone number"):n.value.phone="Phone number is required",a.value.role||(n.value.role="Please select a user role"),a.value.role==="templeadmin"&&(a.value.templeDetails.name||(n.value.templeName="Temple name is required"),a.value.templeDetails.place||(n.value.templePlace="Temple location is required"),a.value.templeDetails.address||(n.value.templeAddress="Temple address is required"),a.value.templeDetails.phoneNumber||(n.value.templePhoneNumber="Temple phone number is required"),(s=a.value.templeDetails.description)!=null&&s.trim()||(n.value.templeDescription="Temple description is required")),Object.keys(n.value).length===0},Ne=async()=>{if(Ce())try{const s={fullName:a.value.fullName,email:a.value.email,phone:a.value.phone,role:a.value.role};h.value||(s.password=a.value.password),a.value.role==="templeadmin"&&(s.templeName=a.value.templeDetails.name,s.templePlace=a.value.templeDetails.place,s.templeAddress=a.value.templeDetails.address,s.templePhoneNo=a.value.templeDetails.phoneNumber,s.templeDescription=a.value.templeDetails.description);let t;h.value?t=await k.updateUser(W.value,s):t=await k.createUser(s),t.success?(V.value=!0,A(t.message||`User ${h.value?"updated":"created"} successfully!`),setTimeout(()=>{le(),j.value=!1,V.value=!1},2e3)):T(t.error||`Failed to ${h.value?"update":"create"} user`)}catch{T(`Failed to ${h.value?"update":"create"} user. Please try again.`)}},Ue=async s=>{try{const t=(s.status||"").toLowerCase()==="active"?"inactive":"active",i=await k.updateUserStatus(s.id,t);i.success?A(i.message||`User status updated to ${t}`):T(i.error||"Failed to update user status")}catch{T("Failed to update user status")}},De=s=>{var t,i,p,C,N,l;h.value=!0,W.value=s.id,a.value={fullName:s.full_name,email:s.email,phone:s.phone,role:(typeof s.role=="object"?(t=s.role)==null?void 0:t.role_name:s.role)||"",isActive:(s.status||"").toLowerCase()==="active",templeDetails:{name:((i=s.temple_details)==null?void 0:i.temple_name)||"",place:((p=s.temple_details)==null?void 0:p.temple_place)||"",address:((C=s.temple_details)==null?void 0:C.temple_address)||"",phoneNumber:((N=s.temple_details)==null?void 0:N.temple_phone_no)||"",description:((l=s.temple_details)==null?void 0:l.temple_description)||""}},j.value=!0},se=()=>{j.value=!1,setTimeout(()=>{le(),h.value=!1,W.value=null,V.value=!1},300)},le=()=>{a.value={fullName:"",email:"",password:"",phone:"",role:"",isActive:!0,templeDetails:{name:"",place:"",address:"",phoneNumber:"",description:""}},n.value={}};return(s,t)=>{var i,p,C,N;return r(),o("div",Le,[e("div",{class:"p-6 border-b border-gray-200 flex justify-between items-center"},[t[16]||(t[16]=e("div",null,[e("h3",{class:"text-lg font-semibold text-gray-900 font-roboto"},"User Management"),e("p",{class:"text-sm text-gray-600 mt-1"},"Create and manage system users")],-1)),e("div",{class:"flex space-x-3"},[e("button",{onClick:ve,class:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"},[...t[14]||(t[14]=[e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})],-1),c(" Bulk Upload User ",-1)])]),e("button",{onClick:me,class:"flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors"},[...t[15]||(t[15]=[e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),c(" Create User ",-1)])])])]),e("div",$e,[e("div",qe,[(r(!0),o(L,null,$(de.filter(l=>l.value!=="all"),l=>(r(),o("button",{key:l.value,onClick:v=>q.value=l.value,class:x(["px-4 py-2 text-sm font-medium transition-colors relative",q.value===l.value?"text-indigo-600 border-b-2 border-indigo-600":"text-gray-600 hover:text-gray-900"])},[c(d(l.label)+" ",1),e("span",{class:x(["ml-2 px-2 py-0.5 text-xs rounded-full",q.value===l.value?"bg-indigo-100 text-indigo-600":"bg-gray-100 text-gray-600"])},d(ce(l.value)),3)],10,Ee))),128))])]),e("div",Re,[e("div",ze,[e("table",Oe,[t[19]||(t[19]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Full Name"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Email"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Phone"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Role"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions")])],-1)),e("tbody",Ie,[J.value?(r(),o("tr",He,[...t[17]||(t[17]=[e("td",{colspan:"6",class:"px-6 py-4"},[e("div",{class:"h-4 bg-gray-200 rounded w-3/4"})],-1)])])):Z.value.length===0?(r(),o("tr",Je,[...t[18]||(t[18]=[e("td",{colspan:"6",class:"px-6 py-4 text-center text-sm text-gray-500"}," No users found in this category. Create your first user by clicking the 'Create User' button or upload users in bulk via CSV. ",-1)])])):u("",!0),(r(!0),o(L,null,$(Z.value,l=>(r(),o("tr",{key:l.id,class:"hover:bg-gray-50"},[e("td",We,[e("div",Ge,d(l.full_name),1)]),e("td",Ke,[e("div",Qe,d(l.email),1)]),e("td",Xe,[e("div",Ye,d(l.phone),1)]),e("td",Ze,[e("span",et,d(fe(l.role)),1)]),e("td",tt,[e("div",st,[e("input",{type:"checkbox",id:`toggle-${l.id}`,checked:(l.status||"").toLowerCase()==="active",onChange:v=>Ue(l),class:"toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"},null,40,lt),e("label",{for:`toggle-${l.id}`,class:"toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"},null,8,at)]),e("span",ot,d((l.status||"").toLowerCase()==="active"?"Active":"Inactive"),1)]),e("td",rt,[e("button",{onClick:v=>De(l),class:"text-indigo-600 hover:text-indigo-900 mr-3"}," Edit ",8,nt),e("div",{class:x({"opacity-50 pointer-events-none select-none":ee(l)})},[re(Fe,{user:l,disabled:ee(l)},null,8,["user","disabled"])],2)])]))),128))])])])]),G.value?(r(),o("div",it,[e("div",dt,[e("div",{class:"px-6 py-4 border-b border-gray-200 flex justify-between items-center"},[t[21]||(t[21]=e("h3",{class:"text-lg font-medium text-gray-900"},"Bulk Upload Users via CSV",-1)),e("button",{onClick:ge,class:"text-gray-400 hover:text-gray-500"},[...t[20]||(t[20]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",ut,[m.value?(r(),o("div",{key:0,class:x(["mb-6 rounded-lg p-4",m.value.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"])},[e("div",pt,[e("div",ct,[m.value.success?(r(),o("svg",mt,[...t[22]||(t[22]=[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)])])):(r(),o("svg",vt,[...t[23]||(t[23]=[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)])]))]),e("div",gt,[e("h3",{class:x(["text-sm font-medium",m.value.success?"text-green-800":"text-red-800"])},d(m.value.success?"Bulk Upload Completed!":"Bulk Upload Failed!"),3),e("div",{class:x(["mt-2 text-sm",m.value.success?"text-green-700":"text-red-700"])},[m.value.success?(r(),o("p",ft,[c(" Successfully processed "+d(((i=m.value.data)==null?void 0:i.total_rows)||0)+" rows. "+d(((p=m.value.data)==null?void 0:p.success_count)||0)+" users created successfully. ",1),((C=m.value.data)==null?void 0:C.failed_count)>0?(r(),o("span",xt,d(m.value.data.failed_count)+" failed. ",1)):u("",!0)])):(r(),o("p",bt,d(m.value.message),1)),(N=m.value.data)!=null&&N.errors&&m.value.data.errors.length>0?(r(),o("ul",ht,[(r(!0),o(L,null,$(m.value.data.errors,(l,v)=>(r(),o("li",{key:v,class:"text-xs"},d(l),1))),128))])):u("",!0)],2)])])],2)):u("",!0),_.value.length?u("",!0):(r(),o("div",yt,[e("div",wt,[e("div",kt,[t[33]||(t[33]=e("svg",{class:"h-5 w-5 text-blue-500 mt-0.5 mr-3",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"})],-1)),e("div",null,[t[32]||(t[32]=e("h4",{class:"text-sm font-medium text-blue-800"},"CSV Upload Instructions",-1)),e("div",_t,[t[30]||(t[30]=e("p",null,"Please ensure your CSV file contains the following columns in exact order:",-1)),e("ul",Ct,[t[25]||(t[25]=e("li",null,[e("strong",null,"Full Name"),c(" - User's complete name")],-1)),t[26]||(t[26]=e("li",null,[e("strong",null,"Email"),c(" - Valid email address")],-1)),t[27]||(t[27]=e("li",null,[e("strong",null,"Phone"),c(" - Phone number")],-1)),t[28]||(t[28]=e("li",null,[e("strong",null,"Password"),c(" - User password")],-1)),e("li",null,[t[24]||(t[24]=e("strong",null,"Role",-1)),c(" - User role ("+d(Q.value.join(", "))+")",1)]),t[29]||(t[29]=oe('<li data-v-9f7a0dec><strong data-v-9f7a0dec>Status</strong> - active or inactive</li><li class="text-amber-700 font-medium mt-2" data-v-9f7a0dec><strong data-v-9f7a0dec>For Temple Admin role, add these additional columns:</strong></li><li class="ml-4" data-v-9f7a0dec><strong data-v-9f7a0dec>Temple Name</strong> - Name of the temple</li><li class="ml-4" data-v-9f7a0dec><strong data-v-9f7a0dec>Temple Place</strong> - City, State location</li><li class="ml-4" data-v-9f7a0dec><strong data-v-9f7a0dec>Temple Address</strong> - Complete address</li><li class="ml-4" data-v-9f7a0dec><strong data-v-9f7a0dec>Temple Phone</strong> - Temple contact number</li><li class="ml-4" data-v-9f7a0dec><strong data-v-9f7a0dec>Temple Description</strong> - Brief temple description</li>',7))]),t[31]||(t[31]=e("p",{class:"mt-2 text-xs text-blue-600"},"Note: Temple fields are required only for users with templeadmin role.",-1))])])])]),e("div",{class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},[t[35]||(t[35]=e("div",null,[e("h4",{class:"text-sm font-medium text-gray-800"},"Need a template?"),e("p",{class:"text-sm text-gray-600"},"Download a sample CSV file with the correct format.")],-1)),e("button",{onClick:he,class:"flex items-center px-3 py-2 bg-gray-600 text-white text-sm rounded-lg hover:bg-gray-700 transition-colors"},[...t[34]||(t[34]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),c(" Download Sample ",-1)])])]),e("div",Nt,[e("div",{onClick:t[0]||(t[0]=l=>s.$refs.fileInput.click()),onDragover:t[1]||(t[1]=I(l=>E.value=!0,["prevent"])),onDragleave:t[2]||(t[2]=I(l=>E.value=!1,["prevent"])),onDrop:I(we,["prevent"]),class:x(["relative border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-gray-400 cursor-pointer transition-colors",{"border-green-400 bg-green-50":E.value}])},[e("input",{ref:"fileInput",type:"file",accept:".csv",onChange:ye,class:"hidden"},null,544),t[36]||(t[36]=oe('<svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" data-v-9f7a0dec><path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-9f7a0dec></path></svg><div class="mt-4" data-v-9f7a0dec><p class="text-lg text-gray-600" data-v-9f7a0dec>Drop your CSV file here or click to browse</p><p class="text-sm text-gray-500 mt-1" data-v-9f7a0dec>Only .csv files are accepted</p></div>',2))],34),y.value?(r(),o("div",Ut,d(y.value),1)):u("",!0)])])),_.value.length>0?(r(),o("div",Dt,[e("div",Pt,[e("div",null,[t[37]||(t[37]=e("h4",{class:"text-lg font-medium text-gray-900"},"CSV Data Preview",-1)),e("p",Tt,d(_.value.length)+" rows found. Review the data before uploading.",1)]),e("button",{onClick:z,class:"text-sm text-gray-500 hover:text-gray-700"}," Upload Different File ")]),e("div",St,[e("table",At,[t[38]||(t[38]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Full Name"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Email"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Phone"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Password"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Role"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Temple Info")])],-1)),e("tbody",Bt,[(r(!0),o(L,null,$(_.value.slice(0,10),(l,v)=>(r(),o("tr",{key:v,class:"hover:bg-gray-50"},[e("td",Vt,d(l.full_name),1),e("td",jt,d(l.email),1),e("td",Mt,d(l.phone),1),e("td",Ft,d(l.password?"****":"Missing"),1),e("td",Lt,[e("span",{class:x(["px-2 py-1 text-xs rounded-full",xe(l.role)?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},d(l.role),3)]),e("td",$t,[e("span",{class:x(["px-2 py-1 text-xs rounded-full",be(l.status)?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},d(l.status),3)]),e("td",qt,[l.role&&l.role.toLowerCase()==="templeadmin"?(r(),o("div",Et,[l.temple_name?(r(),o("span",Rt," ✓ Temple Details ")):(r(),o("span",zt," ✗ Missing "))])):(r(),o("span",Ot,"N/A"))])]))),128))])])]),_.value.length>10?(r(),o("p",It," Showing first 10 rows. "+d(_.value.length-10)+" more rows will be processed. ",1)):u("",!0),e("div",Ht,[e("button",{onClick:z,class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors"}," Cancel "),e("button",{onClick:_e,disabled:M.value||!_.value.length,class:"flex items-center px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[M.value?(r(),o("svg",Wt,[...t[39]||(t[39]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):u("",!0),c(" "+d(M.value?"Uploading...":`Upload ${_.value.length} Users`),1)],8,Jt)])])):u("",!0)])])])):u("",!0),j.value?(r(),o("div",Gt,[e("div",Kt,[e("div",Qt,[e("h3",Xt,d(h.value?"Edit User":"Create New User"),1),e("button",{onClick:se,class:"text-gray-400 hover:text-gray-500"},[...t[40]||(t[40]=[e("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Yt,[V.value?(r(),o("div",Zt,[e("div",es,[t[41]||(t[41]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-green-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1)),e("div",ts,[e("h3",ss,"User "+d(h.value?"Updated":"Created")+" Successfully!",1),e("div",ls,[e("p",null," User account has been "+d(h.value?"updated":"created")+" successfully. ",1)])])])])):u("",!0),V.value?u("",!0):(r(),o("form",{key:1,onSubmit:I(Ne,["prevent"]),class:"space-y-6"},[e("div",null,[t[42]||(t[42]=e("label",{for:"fullName",class:"block text-sm font-medium text-gray-700 mb-2"},[c(" Full Name "),e("span",{class:"text-red-500"},"*")],-1)),U(e("input",{id:"fullName","onUpdate:modelValue":t[3]||(t[3]=l=>a.value.fullName=l),type:"text",placeholder:"Enter full name",required:"",autocomplete:"name",class:x(["block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2.5",{"border-red-500":n.value.fullName}])},null,2),[[P,a.value.fullName]]),n.value.fullName?(r(),o("div",as,d(n.value.fullName),1)):u("",!0)]),e("div",null,[t[43]||(t[43]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700 mb-2"},[c(" Email Address "),e("span",{class:"text-red-500"},"*")],-1)),U(e("input",{id:"email","onUpdate:modelValue":t[4]||(t[4]=l=>a.value.email=l),type:"email",placeholder:"Enter email",required:"",autocomplete:"email",class:x(["block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2.5",{"border-red-500":n.value.email}])},null,2),[[P,a.value.email]]),n.value.email?(r(),o("div",os,d(n.value.email),1)):u("",!0)]),h.value?u("",!0):(r(),o("div",rs,[t[44]||(t[44]=e("label",{for:"password",class:"block text-sm font-medium text-gray-700 mb-2"},[c(" Password "),e("span",{class:"text-red-500"},"*")],-1)),U(e("input",{id:"password","onUpdate:modelValue":t[5]||(t[5]=l=>a.value.password=l),type:"password",placeholder:"Create a strong password",required:"",autocomplete:"new-password",class:x(["block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2.5",{"border-red-500":n.value.password}])},null,2),[[P,a.value.password]]),n.value.password?(r(),o("div",ns,d(n.value.password),1)):u("",!0),re(Se,{password:a.value.password,class:"mt-2"},null,8,["password"])])),e("div",null,[t[45]||(t[45]=e("label",{for:"phone",class:"block text-sm font-medium text-gray-700 mb-2"},[c(" Phone Number "),e("span",{class:"text-red-500"},"*")],-1)),U(e("input",{id:"phone","onUpdate:modelValue":t[6]||(t[6]=l=>a.value.phone=l),type:"tel",placeholder:"Enter phone number",required:"",autocomplete:"tel",class:x(["block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2.5",{"border-red-500":n.value.phone}])},null,2),[[P,a.value.phone]]),n.value.phone?(r(),o("div",is,d(n.value.phone),1)):u("",!0)]),e("div",null,[t[46]||(t[46]=e("label",{for:"role",class:"block text-sm font-medium text-gray-700 mb-2"},[c(" User Role "),e("span",{class:"text-red-500"},"*")],-1)),U(e("select",{id:"role","onUpdate:modelValue":t[7]||(t[7]=l=>a.value.role=l),class:"block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2.5",required:"",disabled:S.value},[e("option",us,d(S.value?"Loading roles...":"Select a role"),1),(r(!0),o(L,null,$(R.value,l=>(r(),o("option",{key:l.id,value:l.role_name},d(l.role_name),9,ps))),128))],8,ds),[[Ae,a.value.role]]),R.value.length===0&&!S.value?(r(),o("div",cs," No roles available. Please check role configuration. ")):u("",!0),n.value.role?(r(),o("div",ms,d(n.value.role),1)):u("",!0)]),a.value.role==="templeadmin"?(r(),o("div",vs,[t[52]||(t[52]=e("h4",{class:"font-medium text-gray-900"},"Temple Details",-1)),e("div",null,[t[47]||(t[47]=e("label",{for:"templeName",class:"block text-sm font-medium text-gray-700 mb-2"},[c(" Temple Name "),e("span",{class:"text-red-500"},"*")],-1)),U(e("input",{id:"templeName","onUpdate:modelValue":t[8]||(t[8]=l=>a.value.templeDetails.name=l),type:"text",placeholder:"Enter temple name",required:"",class:x(["block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2.5",{"border-red-500":n.value.templeName}])},null,2),[[P,a.value.templeDetails.name]]),n.value.templeName?(r(),o("div",gs,d(n.value.templeName),1)):u("",!0)]),e("div",null,[t[48]||(t[48]=e("label",{for:"templePlace",class:"block text-sm font-medium text-gray-700 mb-2"},[c(" Temple Location "),e("span",{class:"text-red-500"},"*")],-1)),U(e("input",{id:"templePlace","onUpdate:modelValue":t[9]||(t[9]=l=>a.value.templeDetails.place=l),type:"text",placeholder:"Enter city, state",required:"",class:x(["block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2.5",{"border-red-500":n.value.templePlace}])},null,2),[[P,a.value.templeDetails.place]]),n.value.templePlace?(r(),o("div",fs,d(n.value.templePlace),1)):u("",!0)]),e("div",null,[t[49]||(t[49]=e("label",{for:"templeAddress",class:"block text-sm font-medium text-gray-700 mb-2"},[c(" Temple Address "),e("span",{class:"text-red-500"},"*")],-1)),U(e("input",{id:"templeAddress","onUpdate:modelValue":t[10]||(t[10]=l=>a.value.templeDetails.address=l),type:"text",placeholder:"Enter complete address",required:"",class:x(["block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2.5",{"border-red-500":n.value.templeAddress}])},null,2),[[P,a.value.templeDetails.address]]),n.value.templeAddress?(r(),o("div",xs,d(n.value.templeAddress),1)):u("",!0)]),e("div",null,[t[50]||(t[50]=e("label",{for:"templePhoneNumber",class:"block text-sm font-medium text-gray-700 mb-2"},[c(" Temple Phone "),e("span",{class:"text-red-500"},"*")],-1)),U(e("input",{id:"templePhoneNumber","onUpdate:modelValue":t[11]||(t[11]=l=>a.value.templeDetails.phoneNumber=l),type:"tel",placeholder:"Enter temple contact number",required:"",class:x(["block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm p-2.5",{"border-red-500":n.value.templePhoneNumber}])},null,2),[[P,a.value.templeDetails.phoneNumber]]),n.value.templePhoneNumber?(r(),o("div",bs,d(n.value.templePhoneNumber),1)):u("",!0)]),e("div",null,[t[51]||(t[51]=e("label",{for:"templeDescription",class:"block text-sm font-medium text-gray-700 mb-2"},[c(" Temple Description "),e("span",{class:"text-red-500"},"*")],-1)),U(e("textarea",{id:"templeDescription","onUpdate:modelValue":t[12]||(t[12]=l=>a.value.templeDetails.description=l),rows:"3",class:"block w-full border border-gray-300 rounded-lg shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm transition-colors duration-200 p-3 leading-relaxed",placeholder:"Brief description about the temple",required:""},null,512),[[P,a.value.templeDetails.description]]),n.value.templeDescription?(r(),o("div",hs,d(n.value.templeDescription),1)):u("",!0)])])):u("",!0),h.value?(r(),o("div",ys,[t[54]||(t[54]=e("label",{for:"status",class:"text-sm font-medium text-gray-700"},"User Status:",-1)),e("div",ws,[U(e("input",{type:"checkbox",id:"status","onUpdate:modelValue":t[13]||(t[13]=l=>a.value.isActive=l),class:"toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"},null,512),[[Be,a.value.isActive]]),t[53]||(t[53]=e("label",{for:"status",class:"toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"},null,-1))]),e("span",ks,d(a.value.isActive?"Active":"Inactive"),1)])):u("",!0),e("div",_s,[e("button",{type:"button",class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",onClick:se}," Cancel "),e("button",{type:"submit",class:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors flex items-center",disabled:H.value},[H.value?(r(),o("svg",Ns,[...t[55]||(t[55]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):u("",!0),c(" "+d(h.value?"Update User":"Create User"),1)],8,Cs)])],32))])])])):u("",!0)])}}},Ss=ne(Us,[["__scopeId","data-v-9f7a0dec"]]);export{Ss as default};
