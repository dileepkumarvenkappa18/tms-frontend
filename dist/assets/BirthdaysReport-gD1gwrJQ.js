import{_ as Le,W as Fe,q as Ne,Z as Be,e as Me,r as _,c as J,E as Oe,s as Ue,I as oe,h as d,j as S,i as s,z as Pe,J as qe,K as je,C as f,t as r,y as ce,n as I,w as Y,k as ne,F as G,l as X,v as ve,G as K,A as Ve,o as u}from"./index-BOrIe162.js";const ze={class:"min-h-screen bg-gray-50"},We={key:0,class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-4"},He={class:"bg-white shadow-sm border-b border-gray-200 rounded-2xl"},Je={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},Ye={class:"flex items-center justify-between"},Ge={class:"text-gray-600 mt-1"},Xe={key:0,class:"text-indigo-600 font-medium"},Ke={key:1,class:"text-indigo-600 font-medium"},Ze={class:"flex items-center space-x-4"},Qe={class:"bg-indigo-50 px-4 py-2 rounded-lg border border-indigo-200"},et={class:"text-indigo-800 font-medium"},tt={class:"text-indigo-600 text-sm ml-2"},st={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},ot={key:2,class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-4"},nt={class:"bg-red-50 border border-red-200 rounded-md p-4"},lt={class:"flex"},at={class:"ml-3"},rt={class:"mt-1 text-sm text-red-700"},it={key:3,class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-4"},dt={class:"bg-yellow-50 border border-yellow-200 rounded-md p-4 text-sm"},ut={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},ct={class:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden mb-8"},vt={class:"p-6"},gt={class:"flex space-x-4 flex-wrap gap-2"},mt={class:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden mb-8"},pt={class:"p-6 border-b border-gray-200"},ft={class:"text-xl font-bold text-gray-900"},yt={class:"text-gray-600 mt-1"},bt={class:"p-6"},ht={class:"mb-6"},xt={class:"flex items-center justify-between mb-2"},wt=["disabled"],_t={class:"relative"},St=["disabled"],kt=["value"],Tt={key:0,class:"text-gray-500"},Dt={key:0,class:"mt-2 text-sm text-amber-600 bg-amber-50 border border-amber-200 rounded-md p-2"},At={key:1,class:"mt-2 text-sm text-green-600"},$t={key:0},Ct={key:0},It={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},Rt={class:"flex flex-wrap gap-2"},Et=["onClick"],Lt={key:1},Ft={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},Nt={class:"flex flex-wrap gap-2"},Bt=["onClick"],Mt={key:0},Ot={class:"relative"},Ut={key:1},Pt={class:"bg-gray-50 border border-gray-200 rounded-md px-3 py-2"},qt={class:"text-gray-700"},jt={key:2},Vt={key:3,class:"mb-6 p-4 bg-gray-50 border border-gray-200 rounded-lg"},zt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Wt={class:"border-t border-gray-200 pt-6"},Ht={class:"flex flex-col md:flex-row md:items-center md:justify-between"},Jt={class:"flex items-center space-x-3"},Yt={class:"relative"},Gt=["value"],Xt=["disabled"],Kt={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},Zt={key:1,class:"mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Qt={class:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden"},es={class:"p-6"},ts={class:"flex flex-wrap gap-2"},ss={class:"inline-flex items-center px-3 py-1.5 rounded-full text-sm bg-indigo-100 text-indigo-800"},os={class:"inline-flex items-center px-3 py-1.5 rounded-full text-sm bg-indigo-100 text-indigo-800"},ns={class:"font-medium mr-1"},ls={key:0},as={key:1},rs={class:"inline-flex items-center px-3 py-1.5 rounded-full text-sm bg-indigo-100 text-indigo-800"},is={class:"inline-flex items-center px-3 py-1.5 rounded-full text-sm bg-indigo-100 text-indigo-800"},ds={key:0},us={class:"inline-flex items-center px-3 py-1.5 rounded-full text-sm bg-indigo-100 text-indigo-800"},cs={class:"inline-flex items-center px-3 py-1.5 rounded-full text-sm bg-indigo-100 text-indigo-800"},vs={__name:"BirthdaysReport",setup(gs,{expose:ge}){const b=Oe();Ve();const U=Fe(),N=Ne(),R=Be(),{showToast:E}=Me(),v=_("birthdays"),p=_("all"),L=_("monthly"),B=_("pdf"),me=_(!1),pe=()=>{const t=new Date;return{start:new Date(t.getTime()-720*60*60*1e3).toISOString().split("T")[0],end:t.toISOString().split("T")[0]}},{start:fe,end:ye}=pe(),k=_(fe),T=_(ye),$=_("all"),C=_(!1),h=_(null),P=_([]),M=_(!1),Z=t=>{if(!t)return!1;const e=String(t).trim();if(e.includes("0000-01-01")||e.includes("0001-01-01")||e.startsWith("0000-")||e.startsWith("0001-"))return!1;try{const o=new Date(e);return!isNaN(o.getTime())&&o.getFullYear()>1900}catch{return!1}},be=t=>{if(!t)return"";const e=String(t).trim();if(e.includes("0000-01-01")||e.includes("0001-01-01")||e.startsWith("0000-")||e.startsWith("0001-"))return"";try{let o,l;if(e.includes("T")||e.includes(" ")&&e.includes("-")){if(!Z(e))return"";const i=new Date(e);if(isNaN(i.getTime())||i.getFullYear()<1900)return"";o=i.getHours(),l=i.getMinutes()}else if(e.includes(":")){const i=e.split(":");o=parseInt(i[0],10),l=parseInt(i[1],10)}else return"";if(isNaN(o)||isNaN(l)||o<0||o>23||l<0||l>59)return"";const n=o>=12?"PM":"AM",a=o%12||12,D=l.toString().padStart(2,"0");return`${a}:${D} ${n}`}catch{return""}},he=t=>{if(!t)return"";const e=String(t).trim();if(e.includes("0000-01-01")||e.includes("0001-01-01")||e.startsWith("0000-")||e.startsWith("0001-"))return"";try{if(!Z(e))return"";const o=new Date(e);return isNaN(o.getTime())||o.getFullYear()<1900?"":o.toLocaleString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch{return""}},Q=[{label:"Weekly",value:"weekly"},{label:"Monthly",value:"monthly"},{label:"Yearly",value:"yearly"},{label:"Custom Range",value:"custom"}],le=[{label:"PDF",value:"pdf"},{label:"CSV",value:"csv"},{label:"Excel",value:"excel"}],xe=J(()=>{var n;const t=(N==null?void 0:N.user)||{},e=(t.role||t.userType||"").toString().toLowerCase(),o=Array.isArray(t.roles)?t.roles.map(a=>(a||"").toString().toLowerCase()):[],l=!!(t.isSuperAdmin||t.is_super_admin);return e==="superadmin"||o.includes("superadmin")||l||((n=b==null?void 0:b.query)==null?void 0:n.from)==="superadmin"}),y=J(()=>!!xe.value),g=J(()=>{var t,e;if(y.value&&b.query.tenants){const o=String(b.query.tenants).split(",").filter(Boolean);if(o.length>1)return null;if(o.length===1)return o[0].trim()}return b.params.tenantId||b.query.tenantId||b.query.tenant_id||((t=N.user)==null?void 0:t.tenantId)||((e=N.user)==null?void 0:e.tenant_id)||(typeof localStorage<"u"?localStorage.getItem("current_tenant_id"):null)||null}),c=J(()=>{if(y.value&&b.query.tenants)return String(b.query.tenants).split(",").map(e=>e.trim()).filter(Boolean);const t=g.value;return t?[t]:[]}),A=J(()=>y.value&&c.value.length>1?P.value||[]:U.temples||[]),ee=t=>{if(t==="all")return"All Temples";const e=A.value.find(o=>{var l;return((l=o.id)==null?void 0:l.toString())===(t==null?void 0:t.toString())});return e?e.name:"Unknown Temple"},q=()=>{switch(v.value){case"birthdays":return"Devotee Birthdays";case"devotees":return"Devotee List";case"statusActive":return"Active Devotees";case"statusInactive":return"Inactive Devotees";case"profile":return"Devotee Profile";default:return"Report"}},we=()=>{switch(v.value){case"birthdays":return"devotee birthday data";case"devotees":return"devotee list data";case"statusActive":return"active devotee data";case"statusInactive":return"inactive devotee data";case"profile":return"devotee profile data";default:return"report data"}},_e=()=>{switch(v.value){case"statusActive":return"Active Only";case"statusInactive":return"Inactive Only";case"devotees":return $.value==="all"?"All Statuses":$.value==="active"?"Active":$.value==="inactive"?"Inactive":$.value==="new"?"New Members":"All";default:return"All"}},Se=t=>{const e=Q.find(o=>o.value===t);return e?e.label:"Unknown"},te=t=>{const e=le.find(o=>o.value===t);return e?e.label:"Unknown"},ae=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",se=()=>{h.value=null},j=t=>{v.value=t,(t==="statusActive"||t==="statusInactive")&&($.value="all")},re=t=>{L.value=t;const e=new Date;if(t==="weekly"){const o=new Date(e.getTime()-6048e5);k.value=o.toISOString().split("T")[0],T.value=e.toISOString().split("T")[0]}else if(t==="monthly"){const o=new Date(e.getTime()-2592e6);k.value=o.toISOString().split("T")[0],T.value=e.toISOString().split("T")[0]}else if(t==="yearly"){const o=new Date(e.getFullYear()-1,e.getMonth(),e.getDate());k.value=o.toISOString().split("T")[0],T.value=e.toISOString().split("T")[0]}},ke=()=>{console.log("Temple changed to:",p.value),se()},ie=()=>{k.value&&T.value&&new Date(k.value)>new Date(T.value)?h.value="Start date cannot be after end date":se()},V=t=>t?{"X-Tenant-ID":String(t),"X-Entity-ID":String(t)}:{},Te=()=>{const t={dateRange:L.value,startDate:k.value,endDate:T.value,format:B.value,isSuperAdmin:y.value,reportType:v.value};if(v.value==="statusActive"?t.status="active":v.value==="statusInactive"?t.status="inactive":v.value==="devotees"&&$.value!=="all"&&(t.status=$.value),p.value!=="all"){const e=p.value,o=A.value.find(l=>String(l.id)===String(e));if(t.templeId=e,t.temple_id=e,t.entityId=e,t.entity_id=e,o){const l=o.tenant_id||o.entityId||o.created_by;l&&(t.tenantId=l,t.tenant_id=l)}else g.value&&(t.tenantId=g.value,t.tenant_id=g.value);t.singleTemple=!0,t.filterByEntity=!0,console.log("Single temple selected - filtering by entity:",{templeId:e,templeTenantId:o==null?void 0:o.tenant_id,params:t})}else y.value&&c.value.length>1?(t.tenantIds=c.value.slice(),t.entityIds=c.value.slice(),t.allTemples=!0):g.value&&(t.tenantId=g.value,t.tenant_id=g.value,t.entityId=g.value,t.entity_id=g.value,t.allTemples=!0),console.log("All temples selected:",{multiTenant:y.value&&c.value.length>1,tenantIds:c.value,params:t});return t},De=async()=>{var t,e;if(!M.value){if(!k.value||!T.value){h.value="Please select both start and end dates",E("Please select both start and end dates","error");return}if(new Date(k.value)>new Date(T.value)){h.value="Start date cannot be after end date",E("Start date cannot be after end date","error");return}if(c.value.length===0){h.value="No tenant selected for report generation",E("No tenant selected for report generation","error");return}if(p.value!=="all"&&!A.value.find(l=>String(l.id)===String(p.value))){h.value="Selected temple not found. Please refresh and try again.",E("Selected temple not found","error");return}M.value=!0,h.value=null;try{const o=Te();console.log("Downloading devotee report with params:",o);let l;if(R)try{switch(v.value){case"birthdays":if(typeof R.downloadDevoteeBirthdaysReport=="function")l=await R.downloadDevoteeBirthdaysReport(o);else throw new Error("Birthday report download method not available in store");break;case"devotees":case"statusActive":case"statusInactive":if(typeof R.downloadDevoteeListReport=="function")l=await R.downloadDevoteeListReport(o);else throw new Error("Devotee list report download method not available in store");break;case"profile":if(typeof R.downloadDevoteeProfileReport=="function")l=await R.downloadDevoteeProfileReport(o);else throw new Error("Devotee profile report download method not available in store");break;default:throw new Error("Unknown report type selected")}if(l&&l.success){const n=p.value==="all"?"all temples":ee(p.value);E(`${q()} for ${n} downloaded successfully as ${te(B.value)}`,"success")}else throw new Error((l==null?void 0:l.message)||"Failed to download report")}catch(n){console.warn("Store method failed, trying direct API call:",n);const a={"Content-Type":"application/json"};if(p.value!=="all"){const x=A.value.find(Ee=>String(Ee.id)===String(p.value)),H=(x==null?void 0:x.tenant_id)||(x==null?void 0:x.entityId)||(x==null?void 0:x.created_by)||g.value;H&&Object.assign(a,V(H))}else g.value&&c.value.length===1&&Object.assign(a,V(g.value));let D="",i=[];v.value==="birthdays"?i=["/reports/devotees/birthdays/download","/reports/devotees/birthdays","/devotees/birthdays/report"]:["devotees","statusActive","statusInactive"].includes(v.value)?i=["/reports/devotees/list/download","/reports/devotees/list","/devotees/list/report"]:v.value==="profile"&&(i=["/reports/devotees/profile/download","/reports/devotees/profile/download","/api/reports/devotees/profile","/devotees/profile/report"]);let m=null,w=null;for(const x of i)try{if(console.log("Trying endpoint:",x),m=await K.post(x,o,{responseType:"blob",headers:a}),m&&m.data){D=x,console.log("Success with endpoint:",D);break}}catch(H){console.warn(`Endpoint ${x} failed:`,H.message),w=H}if(!m||!m.data)throw new Error(`All API endpoints failed. Last error: ${(w==null?void 0:w.message)||"Unknown error"}. Please contact support.`);const O=m.headers["content-type"]||"application/octet-stream",F=new Blob([m.data],{type:O}),ue=window.URL.createObjectURL(F),W=document.createElement("a");W.href=ue;const $e=new Date().toISOString().split("T")[0],Ce=q().toLowerCase().replace(/\s+/g,"-"),Ie=p.value==="all"?"all-temples":`temple-${p.value}`;W.download=`${Ce}-${Ie}-${$e}.${o.format}`,document.body.appendChild(W),W.click(),document.body.removeChild(W),window.URL.revokeObjectURL(ue);const Re=p.value==="all"?"all temples":ee(p.value);E(`${q()} for ${Re} downloaded successfully as ${te(B.value)}`,"success")}else throw new Error("Reports store is not available")}catch(o){console.error("Error downloading report:",o);const l=((e=(t=o.response)==null?void 0:t.data)==null?void 0:e.message)||o.message||"Unknown error occurred";h.value=`Failed to download report: ${l}`,E(`Failed to download report: ${l}`,"error")}finally{M.value=!1}}},z=async()=>{var t,e,o;C.value=!0,h.value=null;try{if(U.temples=[],P.value=[],c.value.length===0){console.warn("No tenant IDs available for fetching temples"),h.value="No tenant selected to load temples.";return}if(console.log("=== Starting Temple Fetch ==="),console.log("Tenant IDs to fetch:",c.value),console.log("Is Multi-tenant:",y.value&&c.value.length>1),y.value&&c.value.length>1){console.log(`Fetching temples for ${c.value.length} tenants:`,c.value);const l=c.value.map(i=>(console.log(`Creating request for tenant: ${i}`),de(i).catch(m=>(console.error(`Failed to fetch temples for tenant ${i}:`,m),[]))));console.log(`Executing ${l.length} parallel requests...`);const n=await Promise.allSettled(l);console.log("Results from Promise.allSettled:",n);const a=[];for(let i=0;i<n.length;i++){const m=n[i],w=c.value[i];m.status==="fulfilled"?(console.log(`Tenant ${w}: ${((t=m.value)==null?void 0:t.length)||0} temples`),Array.isArray(m.value)&&m.value.length>0&&a.push(...m.value)):console.error(`Tenant ${w}: Request failed`,m.reason)}console.log(`Total temples aggregated: ${a.length}`);const D=new Set;P.value=a.filter(i=>D.has(i.id)?(console.log(`Duplicate temple found: ${i.id} - ${i.name}`),!1):(D.add(i.id),!0)),console.log(`After deduplication: ${P.value.length} unique temples`),console.log("Temple details:",P.value.map(i=>({id:i.id,name:i.name,tenant:i.tenant_id})))}else if(g.value){console.log("Fetching temples for single tenant:",g.value);const l=await de(g.value);U.temples=l,console.log(`Loaded ${U.temples.length} temples for tenant ${g.value}`),console.log("Temple details:",U.temples.map(n=>({id:n.id,name:n.name,tenant:n.tenant_id})))}else console.warn("No tenant ID available to fetch temples"),h.value="No tenant selected to load temples.";console.log("=== Temple Fetch Complete ===")}catch(l){console.error("Error in fetchTemples:",l);const n=((o=(e=l.response)==null?void 0:e.data)==null?void 0:o.message)||l.message||"Unknown error occurred";h.value=`Failed to load temple data: ${n}`}finally{C.value=!1}},de=async t=>{console.log(`Fetching temples for tenant: ${t}`);try{let e=[];try{console.log(`Strategy 1: Trying /v1/temples for tenant ${t}`);const o=await K.get("/temples",{params:{tenant_id:t,entityId:t,entity_id:t},headers:V(t)});let l=[];if(Array.isArray(o.data)?l=o.data:o.data&&Array.isArray(o.data.data)?l=o.data.data:o.data&&Array.isArray(o.data.temples)&&(l=o.data.temples),console.log(`Found ${l.length} temples from /v1/temples for tenant ${t}`),l.length>0)return e=l.map(n=>({id:n.id,name:n.name||n.temple_name||n.entity_name||"Unknown Temple",status:n.status||"active",tenant_id:n.tenant_id||n.entityId||n.created_by||t,created_by:n.created_by||t,entityId:n.entityId||n.tenant_id||t})),e}catch(o){console.log(`Strategy 1 failed for tenant ${t}:`,o.message)}try{console.log(`Strategy 2: Trying /entities for tenant ${t}`);const o=await K.get("/entities",{params:{tenant_id:t,entityId:t,entity_id:t,created_by:t},headers:V(t)});let l=[];Array.isArray(o.data)?l=o.data:o.data&&Array.isArray(o.data.data)?l=o.data.data:o.data&&Array.isArray(o.data.entities)&&(l=o.data.entities),console.log(`Got ${l.length} total entities from /entities`);const n=l.filter(a=>{const D=String(a.created_by||""),i=String(a.tenant_id||""),m=String(a.entityId||""),w=String(t),O=D===w||i===w||m===w;return O&&console.log(`Entity ${a.id} (${a.name}) belongs to tenant ${t}`),O});if(console.log(`Filtered ${n.length} entities for tenant ${t}`),n.length>0)return e=n.map(a=>({id:a.id,name:a.name||a.temple_name||a.entity_name||"Unknown Temple",status:a.status||"active",tenant_id:a.tenant_id||a.entityId||a.created_by||t,created_by:a.created_by||t,entityId:a.entityId||a.tenant_id||t})),e}catch(o){console.log(`Strategy 2 failed for tenant ${t}:`,o.message)}try{console.log(`Strategy 3: Trying /entities without filters for tenant ${t}`);const o=await K.get("/entities",{headers:V(t)});let l=[];Array.isArray(o.data)?l=o.data:o.data&&Array.isArray(o.data.data)&&(l=o.data.data),console.log(`Got ${l.length} total entities from /entities (no filter)`);const n=l.filter(a=>{const D=String(a.created_by||""),i=String(a.tenant_id||""),m=String(a.entityId||""),w=String(a.owner_id||""),O=String(a.user_id||""),F=String(t);return D===F||i===F||m===F||w===F||O===F});if(console.log(`Client-side filtered ${n.length} entities for tenant ${t}`),n.length>0)return e=n.map(a=>({id:a.id,name:a.name||a.temple_name||a.entity_name||"Unknown Temple",status:a.status||"active",tenant_id:a.tenant_id||a.entityId||a.created_by||t,created_by:a.created_by||t,entityId:a.entityId||a.tenant_id||t})),e}catch(o){console.error(`Strategy 3 failed for tenant ${t}:`,o)}return console.warn(`All strategies failed for tenant ${t}, returning empty array`),[]}catch(e){return console.error(`Error fetching temples for tenant ${t}:`,e),[]}},Ae=async()=>{await z()};return Ue(async()=>{console.log("Component mounted with tenant context:",{fromSuperadmin:y.value,effectiveTenantId:g.value,tenantIds:c.value,routeQuery:b.query,routeParams:b.params}),await z()}),oe(c,async(t,e)=>{t&&t.length>0&&JSON.stringify(t)!==JSON.stringify(e)&&(console.log("Tenant IDs changed, refetching temples:",{old:e,new:t}),await z())},{deep:!0}),oe(g,async(t,e)=>{t!==e&&(console.log("Effective tenant ID changed, refetching temples:",{old:e,new:t}),await z())}),oe(()=>b.query,async(t,e)=>{(t.tenants!==e.tenants||t.tenantId!==e.tenantId)&&(console.log("Route query changed, updating tenant context:",{old:e,new:t}),await z())},{deep:!0}),ge({formatTime12Hour:be,formatDateTime:he,isValidDate:Z}),(t,e)=>{var l;const o=je("router-link");return u(),d("div",ze,[y.value?(u(),d("div",We,[Pe(o,{to:"/superadmin/reports",class:"inline-flex items-center px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors"},{default:qe(()=>[...e[10]||(e[10]=[s("svg",{class:"mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),f(" Back to SuperAdmin Reports ",-1)])]),_:1})])):S("",!0),s("div",He,[s("div",Je,[s("div",Ye,[s("div",null,[e[12]||(e[12]=s("h1",{class:"text-2xl font-bold text-gray-900"},"Devotee Reports",-1)),s("p",Ge,[e[11]||(e[11]=f(" Download devotee data for your temples ",-1)),y.value&&c.value.length>1?(u(),d("span",Xe," (Multiple Tenants: "+r(c.value.length)+" selected) ",1)):g.value?(u(),d("span",Ke," (Tenant ID: "+r(g.value)+") ",1)):S("",!0)])]),s("div",Ze,[s("div",Qe,[s("span",et,r(((l=ce(N).user)==null?void 0:l.name)||"Tenant User"),1),s("span",tt,r(y.value?"(Super Admin)":"(Tenant)"),1)])])])])]),C.value?(u(),d("div",st,[...e[13]||(e[13]=[s("div",{class:"bg-white rounded-lg p-6 flex items-center space-x-3"},[s("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-indigo-600"}),s("span",{class:"text-gray-900 font-medium"},"Loading data...")],-1)])])):S("",!0),h.value?(u(),d("div",ot,[s("div",nt,[s("div",lt,[e[16]||(e[16]=s("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})],-1)),s("div",at,[e[14]||(e[14]=s("h3",{class:"text-sm font-medium text-red-800"},"Error",-1)),s("p",rt,r(h.value),1)]),s("div",{class:"ml-auto pl-3"},[s("button",{onClick:se,class:"text-red-400 hover:text-red-500"},[...e[15]||(e[15]=[s("span",{class:"sr-only"},"Dismiss",-1),s("svg",{class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[s("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])])])])])])):S("",!0),me.value?(u(),d("div",it,[s("div",dt,[e[23]||(e[23]=s("h4",{class:"font-medium text-yellow-800"},"Debug Info:",-1)),s("p",null,[e[17]||(e[17]=s("strong",null,"From Superadmin:",-1)),f(" "+r(y.value),1)]),s("p",null,[e[18]||(e[18]=s("strong",null,"Effective Tenant ID:",-1)),f(" "+r(g.value),1)]),s("p",null,[e[19]||(e[19]=s("strong",null,"Tenant IDs:",-1)),f(" "+r(JSON.stringify(c.value)),1)]),s("p",null,[e[20]||(e[20]=s("strong",null,"Selected Temple:",-1)),f(" "+r(p.value),1)]),s("p",null,[e[21]||(e[21]=s("strong",null,"Available Temples:",-1)),f(" "+r(A.value.length),1)]),s("p",null,[e[22]||(e[22]=s("strong",null,"Route Query:",-1)),f(" "+r(JSON.stringify(ce(b).query)),1)])])])):S("",!0),s("div",ut,[s("div",ct,[s("div",vt,[e[24]||(e[24]=s("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Select Report Type",-1)),s("div",gt,[s("button",{onClick:e[0]||(e[0]=n=>j("birthdays")),class:I(["px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200",v.value==="birthdays"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])}," Devotee Birthdays ",2),s("button",{onClick:e[1]||(e[1]=n=>j("devotees")),class:I(["px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200",v.value==="devotees"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])}," Devotee List ",2),s("button",{onClick:e[2]||(e[2]=n=>j("statusActive")),class:I(["px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200",v.value==="statusActive"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])}," Active Devotees ",2),s("button",{onClick:e[3]||(e[3]=n=>j("statusInactive")),class:I(["px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200",v.value==="statusInactive"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])}," Inactive Devotees ",2),s("button",{onClick:e[4]||(e[4]=n=>j("profile")),class:I(["px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200",v.value==="profile"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])}," Devotee Profile ",2)])])]),s("div",mt,[s("div",pt,[s("h3",ft,r(q()),1),s("p",yt," Configure filters and download "+r(we()),1)]),s("div",bt,[s("div",ht,[s("div",xt,[e[26]||(e[26]=s("label",{class:"block text-gray-700 font-medium"},"Select Temple",-1)),s("button",{onClick:Ae,disabled:C.value,class:"inline-flex items-center px-3 py-1.5 text-xs font-medium text-indigo-600 bg-indigo-50 border border-indigo-200 rounded-md hover:bg-indigo-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed"},[(u(),d("svg",{class:I(["mr-1 h-3 w-3",{"animate-spin":C.value}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...e[25]||(e[25]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2)),f(" "+r(C.value?"Refreshing...":"Refresh"),1)],8,wt)]),s("div",_t,[Y(s("select",{"onUpdate:modelValue":e[5]||(e[5]=n=>p.value=n),class:"block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",onChange:ke,disabled:C.value},[e[27]||(e[27]=s("option",{value:"all"},"All Temples",-1)),(u(!0),d(G,null,X(A.value,n=>(u(),d("option",{key:n.id,value:n.id},[f(r(n.name)+" ",1),n.tenant_id?(u(),d("span",Tt,"(Tenant: "+r(n.tenant_id)+")",1)):S("",!0)],8,kt))),128))],40,St),[[ne,p.value]])]),A.value.length===0&&!C.value?(u(),d("div",Dt,[...e[28]||(e[28]=[s("div",{class:"flex items-center"},[s("svg",{class:"h-4 w-4 text-amber-500 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})]),f(" No temples found for selected tenant(s). Please check tenant access or try refreshing. ")],-1)])])):A.value.length>0?(u(),d("div",At,[f(r(A.value.length)+" temple"+r(A.value.length!==1?"s":"")+" available ",1),y.value&&c.value.length>1?(u(),d("span",$t," across "+r(c.value.length)+" tenant"+r(c.value.length!==1?"s":""),1)):S("",!0)])):S("",!0)]),v.value==="birthdays"?(u(),d("div",Ct,[s("div",It,[s("div",null,[e[29]||(e[29]=s("label",{class:"block text-gray-700 font-medium mb-2"},"Birthday Period",-1)),s("div",Rt,[(u(),d(G,null,X(Q,n=>s("button",{key:n.value,onClick:a=>re(n.value),class:I(["px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200",L.value===n.value?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},r(n.label),11,Et)),64))])])])])):["devotees","statusActive","statusInactive"].includes(v.value)?(u(),d("div",Lt,[s("div",Ft,[s("div",null,[e[30]||(e[30]=s("label",{class:"block text-gray-700 font-medium mb-2"},"Join Date Period",-1)),s("div",Nt,[(u(),d(G,null,X(Q,n=>s("button",{key:n.value,onClick:a=>re(n.value),class:I(["px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200",L.value===n.value?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"])},r(n.label),11,Bt)),64))])]),v.value==="devotees"?(u(),d("div",Mt,[e[32]||(e[32]=s("label",{class:"block text-gray-700 font-medium mb-2"},"Devotee Status",-1)),s("div",Ot,[Y(s("select",{"onUpdate:modelValue":e[6]||(e[6]=n=>$.value=n),class:"block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"},[...e[31]||(e[31]=[s("option",{value:"all"},"All Statuses",-1),s("option",{value:"active"},"Active",-1),s("option",{value:"inactive"},"Inactive",-1),s("option",{value:"new"},"New Members",-1)])],512),[[ne,$.value]])])])):v.value==="statusActive"||v.value==="statusInactive"?(u(),d("div",Ut,[e[33]||(e[33]=s("label",{class:"block text-gray-700 font-medium mb-2"},"Status Filter",-1)),s("div",Pt,[s("span",qt,r(v.value==="statusActive"?"Active Devotees Only":"Inactive Devotees Only"),1)])])):S("",!0)])])):v.value==="profile"?(u(),d("div",jt,[...e[34]||(e[34]=[s("p",{class:"text-gray-600 mb-6"},"This report includes detailed profile information for devotees.",-1)])])):S("",!0),L.value==="custom"?(u(),d("div",Vt,[s("div",zt,[s("div",null,[e[35]||(e[35]=s("label",{class:"block text-gray-700 text-sm font-medium mb-2"},"Start Date",-1)),Y(s("input",{type:"date","onUpdate:modelValue":e[7]||(e[7]=n=>k.value=n),class:"w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",onChange:ie},null,544),[[ve,k.value]])]),s("div",null,[e[36]||(e[36]=s("label",{class:"block text-gray-700 text-sm font-medium mb-2"},"End Date",-1)),Y(s("input",{type:"date","onUpdate:modelValue":e[8]||(e[8]=n=>T.value=n),class:"w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",onChange:ie},null,544),[[ve,T.value]])])])])):S("",!0),s("div",Wt,[s("div",Ht,[e[39]||(e[39]=s("div",{class:"mb-4 md:mb-0"},[s("h4",{class:"text-lg font-medium text-gray-900"},"Download Report"),s("p",{class:"text-sm text-gray-600"},"Select a format and click download")],-1)),s("div",Jt,[s("div",Yt,[Y(s("select",{"onUpdate:modelValue":e[9]||(e[9]=n=>B.value=n),class:"block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"},[(u(),d(G,null,X(le,n=>s("option",{key:n.value,value:n.value},r(n.label),9,Gt)),64))],512),[[ne,B.value]])]),s("button",{onClick:De,disabled:M.value,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed"},[M.value?(u(),d("svg",Kt,[...e[37]||(e[37]=[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(u(),d("svg",Zt,[...e[38]||(e[38]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"},null,-1)])])),f(" "+r(M.value?"Downloading...":"Download"),1)],8,Xt)])])])])]),s("div",Qt,[s("div",es,[e[45]||(e[45]=s("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"Applied Filters",-1)),s("div",ts,[s("div",ss,[e[40]||(e[40]=s("span",{class:"font-medium mr-1"},"Report Type:",-1)),f(" "+r(q()),1)]),s("div",os,[s("span",ns,r(y.value&&c.value.length>1?"Tenants:":"Tenant:"),1),y.value&&c.value.length>1?(u(),d("span",ls,r(c.value.length)+" selected ",1)):(u(),d("span",as,r(g.value),1))]),s("div",rs,[e[41]||(e[41]=s("span",{class:"font-medium mr-1"},"Temple:",-1)),f(" "+r(p.value==="all"?"All Temples":ee(p.value)),1)]),s("div",is,[e[42]||(e[42]=s("span",{class:"font-medium mr-1"},"Period:",-1)),f(" "+r(Se(L.value))+" ",1),L.value==="custom"?(u(),d("span",ds," ("+r(ae(k.value))+" - "+r(ae(T.value))+") ",1)):S("",!0)]),s("div",us,[e[43]||(e[43]=s("span",{class:"font-medium mr-1"},"Status:",-1)),f(" "+r(_e()),1)]),s("div",cs,[e[44]||(e[44]=s("span",{class:"font-medium mr-1"},"Format:",-1)),f(" "+r(te(B.value)),1)])]),e[46]||(e[46]=s("p",{class:"mt-4 text-sm text-gray-600"}," Your report will include data based on the filters above. Click Download to generate and download the report. ",-1))])])])])}}},ps=Le(vs,[["__scopeId","data-v-9e530f3f"]]);export{ps as default};
