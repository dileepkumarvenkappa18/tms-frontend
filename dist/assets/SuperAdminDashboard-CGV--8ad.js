import{r as f,c as xe,s as we,h as m,i as t,j as k,C,z as be,J as ke,K as _e,t as g,w as Y,k as Ae,F as Z,l as ee,v as Ce,e as De,o as p,n as je}from"./index-y_ul9IQ_.js";import{s as $}from"./superadmin.service-CUFcWLVX.js";const Te={class:"min-h-screen bg-gray-50"},Ue={class:"bg-white border-b border-gray-200 shadow-sm"},$e={class:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-6 xl:px-8 py-4 sm:py-6"},Se={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},Re={class:"flex items-center space-x-4"},Me={key:0,class:"flex items-center text-sm text-gray-500"},Le={class:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-6 xl:px-8 py-4 sm:py-6 lg:py-8"},Ne={class:"flex flex-wrap gap-2 sm:gap-4 mb-6 sm:mb-8"},Ee={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 mb-6 sm:mb-8"},Ie={class:"bg-white rounded-xl shadow-md p-6 border border-gray-100 hover:shadow-lg transition-all duration-200"},Pe={class:"flex items-center justify-between"},ze={class:"text-3xl font-bold text-orange-600 mt-2"},Be={class:"bg-white rounded-xl shadow-md p-6 border border-gray-100 hover:shadow-lg transition-all duration-200"},Fe={class:"flex items-center justify-between"},We={class:"text-3xl font-bold text-green-600 mt-2"},Ve={class:"mt-4"},He={class:"text-sm text-green-600"},Oe={class:"bg-white rounded-xl shadow-md p-6 border border-gray-100 hover:shadow-lg transition-all duration-200"},Je={class:"flex items-center justify-between"},Ge={class:"text-3xl font-bold text-indigo-600 mt-2"},Ke={class:"bg-white rounded-xl shadow-md p-6 border border-gray-100 hover:shadow-lg transition-all duration-200"},qe={class:"flex items-center justify-between"},Qe={class:"text-3xl font-bold text-red-600 mt-2"},Xe={class:"bg-white rounded-xl shadow-md border border-gray-100 mb-8"},Ye={class:"px-6 py-4 border-b border-gray-200"},Ze={class:"flex items-center justify-between"},et={class:"flex items-center space-x-3"},tt={key:0,class:"flex justify-center items-center py-12"},st={key:1,class:"divide-y divide-gray-200"},ot={key:0,class:"text-center py-12"},nt={class:"flex items-start justify-between"},rt={class:"flex-1"},lt={class:"flex items-center space-x-3 mb-3"},at={class:"text-lg font-semibold text-gray-900"},it={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 mb-4"},dt={class:"font-medium text-gray-900"},ut={class:"font-medium text-gray-900"},ct={class:"font-medium text-gray-900"},mt={class:"font-medium text-gray-900"},pt={class:"font-medium text-indigo-600"},gt={key:0,class:"mb-4"},vt={class:"text-gray-900"},ft={key:1,class:"mb-4"},ht={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mt-1"},yt={class:"text-yellow-800 text-sm"},xt={class:"flex flex-col sm:flex-row lg:flex-col space-y-2 sm:space-y-0 sm:space-x-2 lg:space-x-0 lg:space-y-2 ml-0 sm:ml-4 lg:ml-6 mt-4 sm:mt-0"},wt=["onClick"],bt={key:0,class:"flex flex-col space-y-2"},kt=["onClick","disabled"],_t=["onClick","disabled"],At={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},Ct={class:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto"},Dt={class:"p-6"},jt={key:0,class:"space-y-6"},Tt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ut={class:"font-medium text-gray-900"},$t={class:"font-medium text-gray-900"},St={class:"md:col-span-2"},Rt={class:"font-medium text-gray-900"},Mt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Lt={class:"font-medium text-gray-900"},Nt={class:"font-medium text-gray-900"},Et={key:0,class:"p-4 border border-dashed border-gray-300 rounded-lg text-sm text-gray-600"},It={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-3"},Pt={class:"flex items-center justify-center w-10 h-10 rounded bg-indigo-50 text-indigo-600"},zt={key:0,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Bt={key:1,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ft={key:2,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Wt={class:"flex-1 min-w-0"},Vt={class:"text-sm font-medium text-gray-900 truncate"},Ht={class:"text-xs text-gray-500"},Ot={class:"flex items-center space-x-2"},Jt=["onClick","disabled"],Gt=["onClick","disabled"],Kt={key:0,class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},qt={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Qt={class:"px-6 py-4 border-t border-gray-200 flex justify-end space-x-3"},Xt={key:0,class:"flex space-x-3"},Yt=["disabled"],Zt=["disabled"],es={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},ts={class:"bg-white rounded-xl shadow-xl max-w-md w-full"},ss={class:"p-6"},os={class:"px-6 py-4 border-t border-gray-200 flex justify-end space-x-3"},ns=["disabled"],rs={key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},ls={class:"bg-white rounded-xl shadow-xl max-w-3xl w-full max-h-[80vh] overflow-auto"},as={class:"px-6 py-4 border-b border-gray-200 flex items-center justify-between"},is={class:"p-6"},ds={class:"bg-gray-100 p-4 rounded font-mono text-xs overflow-auto whitespace-pre"},us={class:"px-6 py-4 border-t border-gray-200 flex justify-end"},gs={__name:"SuperAdminDashboard",setup(cs){const c=De(),S=f(!1),W=f(!1),x=f(!1),P=f(!1),L=f("all"),T=f(!1),z=f(!1),v=f(null),D=f(""),te=f(!1),N=f(!1),E=f(""),R=f("Not tested"),B=f(null),w=f({pendingApprovals:0,activeTemples:0,totalUsers:0,rejectedTemples:0,newThisWeek:0}),y=f([]),V=f([]),A=f(null),H=xe(()=>L.value==="all"?y.value:y.value.filter(s=>s.status.toLowerCase()===L.value.toLowerCase())),se=s=>{const e=((s==null?void 0:s.type)||"").toLowerCase(),r=((s==null?void 0:s.name)||(s==null?void 0:s.filename)||"").toLowerCase();return e.includes("pdf")||r.endsWith(".pdf")},oe=s=>{const e=((s==null?void 0:s.type)||"").toLowerCase(),r=((s==null?void 0:s.name)||(s==null?void 0:s.filename)||"").toLowerCase();return e.startsWith("image/")||r.endsWith(".png")||r.endsWith(".jpg")||r.endsWith(".jpeg")||r.endsWith(".webp")},ne=s=>{if(!s&&s!==0)return"";const e=["B","KB","MB","GB"];let r=0,l=Number(s);for(;l>=1024&&r<e.length-1;)l/=1024,r++;return`${l.toFixed(1)} ${e[r]}`},re=s=>{const e=[];return s.size&&e.push(ne(s.size)),s.type&&e.push(s.type),e.join(" â€¢ ")||"Document"},le=s=>typeof s=="string"?s:"",M=(s,e)=>{const r=(e||"").toLowerCase(),l=(s||"").toLowerCase(),o=r||l;return o.endsWith(".pdf")?"application/pdf":o.endsWith(".png")?"image/png":o.endsWith(".jpg")||o.endsWith(".jpeg")?"image/jpeg":""},ae=s=>{console.log("normalizeTempleDocuments - input temple:",s);const e=[],r=n=>{if(!n)return"";let i=n.trim();return i=i.replace(/\/files\//g,"/"),/uploads\/\d+\//.test(i)&&(console.log("normalizeTempleDocuments - removing WRONG folder:",i),i=i.replace(/uploads\/\d+\//,"uploads/")),i=i.replace(/^\/+/,""),i},l=new Set,o=n=>!n.url||l.has(n.url)?(console.log("Skipping duplicate URL:",n.url),!1):(l.add(n.url),e.push(n),console.log("Added document:",n.name,"| URL:",n.url),!0);Array.isArray(s.documents)&&s.documents.length>0&&(console.log("normalizeTempleDocuments - found documents array:",s.documents),s.documents.forEach((n,i)=>{let d=n.download_url||n.downloadUrl||n.url||n.file_url||n.fileUrl||n.path||"";d=r(d),d&&o({id:n.id||`doc-${i}-${Date.now()}`,name:n.name||n.filename||`Document ${i+1}`,type:n.type||M(d,n.name||n.filename),size:n.size||null,url:d})})),[{key:"registration_cert",label:"Registration Certificate"},{key:"trust_deed",label:"Trust Deed"},{key:"property_docs",label:"Property Documents"}].forEach(({key:n,label:i})=>{let h=[s[`${n}_url`],s[`${n}Url`],s[n],s[`${n}_path`],s[`${n}_link`]].map(le).filter(Boolean).find(b=>b.startsWith("http")||b.startsWith("/"))||"";h=r(h),h&&(console.log(`normalizeTempleDocuments - checking single field ${n}:`,h),o({id:`${n}-${Date.now()}`,name:i,type:M(h,i),size:null,url:h}))});const u=[s.additional_docs,s.additionalDocs,s.additional_documents,s.additionalDocuments].find(n=>Array.isArray(n));return u&&u.length>0&&(console.log("normalizeTempleDocuments - found additional docs:",u),u.forEach((n,i)=>{let d=n.download_url||n.downloadUrl||n.url||n.file_url||n.fileUrl||n.path||"";d=r(d),d&&o({id:n.id||`additional-${i}-${Date.now()}`,name:n.name||n.filename||`Additional Document ${i+1}`,type:n.type||M(d,n.name||n.filename),size:n.size||null,url:d})})),[s.additional_docs_urls,s.additionalDocsUrls,s.additional_docs_info,s.additionalDocsInfo].forEach(n=>{if(typeof n=="string"&&n.trim()&&n!=="[]")try{const i=JSON.parse(n);Array.isArray(i)&&i.forEach((d,h)=>{let b="";typeof d=="string"?b=r(d):typeof d=="object"&&(b=r(d.url||d.file_url||d.fileUrl||"")),b&&o({id:`json-doc-${h}-${Date.now()}`,name:d.name||d.filename||`Document ${h+1}`,type:d.type||M(b,d.name),size:d.size||null,url:b})})}catch(i){console.warn("Failed to parse JSON field:",n,i)}}),console.log(`âœ… normalizeTempleDocuments - final count: ${e.length} documents`),console.log("Final docs:",e),e},O=(s,e,r="view")=>{console.log("buildDocUrl - doc:",s),console.log("buildDocUrl - appId:",e),console.log("buildDocUrl - action:",r);let l=s.download_url||s.downloadUrl||s.url||s.file_url||s.fileUrl||s.path||"";if(console.log("buildDocUrl - direct (raw):",l),!l){if(s.id&&e){const u=`http://localhost:8080/api/v1/entities/${encodeURIComponent(e)}/documents/${encodeURIComponent(s.id)}/${r}`;return console.log("buildDocUrl - API fallback:",u),u}return""}if(l=l.replace(/\/files\//g,"/"),/uploads\/\d+\//.test(l)&&(console.log("buildDocUrl - removing WRONG temple folder:",l),l=l.replace(/uploads\/\d+\//,"uploads/")),l.startsWith("http://")||l.startsWith("https://")){let u=l;if(r==="download"){const _=u.includes("?")?"&":"?";u=`${u}${_}download=true&filename=${encodeURIComponent(s.name||s.filename||"document")}`}return console.log("buildDocUrl - absolute URL returned:",u),u}let o=l.replace(/^\/+/,"");o.startsWith("uploads/")||(o=`uploads/${o}`),o=o.replace(/uploads\/uploads\//g,"uploads/");let a=`http://localhost:8080/${o}`;return r==="download"&&(a=`${a}?download=true&filename=${encodeURIComponent(s.name||s.filename||"document")}`),console.log("buildDocUrl - FINAL URL:",a),a},ie=s=>{try{window.open(s,"_blank","noopener,noreferrer")||c.warning("Pop-up blocked. Please allow pop-ups for this site.")}catch(e){console.error("Error opening new tab:",e),c.error("Unable to open document in a new tab.")}},j=s=>((s||"").trim()||"document").replace(/[\\/:*?"<>|\u0000-\u001F]/g,"_").slice(0,200),de=s=>{if(!s)return"";const e=/filename\*\s*=\s*([^;]+)/i.exec(s);if(e){let l=e[1].trim();l=l.replace(/^"+|"+$/g,""),l.toLowerCase().startsWith("utf-8''")&&(l=l.substring(7));try{return j(decodeURIComponent(l))}catch{return j(l)}}const r=/filename\s*=\s*("?)([^";]+)\1/i.exec(s);return r&&r[2]?j(r[2]):""},ue=s=>{try{const r=new URL(s,window.location.origin).pathname.split("/").filter(Boolean).pop()||"";return j(decodeURIComponent(r))}catch{const r=(s||"").split("?")[0].split("#")[0].split("/").filter(Boolean).pop()||"";try{return j(decodeURIComponent(r))}catch{return j(r)}}},ce=(s,e,r)=>j(de(r)||(s==null?void 0:s.name)||(s==null?void 0:s.filename)||ue(e)||"document"),me=async s=>{if(console.log("viewDocument called with doc:",s),!v.value){console.log("viewDocument - no selected application");return}const e=O(s,v.value.id,"view");if(console.log("viewDocument - built URL:",e),!e){c.error("View URL not available for this document.");return}try{console.log("viewDocument - opening URL directly in new tab:",e),ie(e)}catch(r){console.error("Error viewing document:",r),c.error("Failed to open document for viewing.")}},pe=async s=>{if(console.log("downloadDocument called with doc:",s),!v.value)return;const e=v.value.id,r=O(s,e,"download"),l=r?r.includes("?")?`${r}&download=true&filename=${encodeURIComponent(s.name||s.filename||"document")}`:`${r}?download=true&filename=${encodeURIComponent(s.name||s.filename||"document")}`:"";if(console.log("downloadDocument - built download URL:",l),!l){c.error("Download URL not available for this document.");return}const o=s.id||s.name;A.value=o;try{console.log("downloadDocument - trying fetch blob method");const a=localStorage.getItem("auth_token")||localStorage.getItem("authToken")||"",u=await fetch(API_URL+l,{method:"GET",headers:{...a?{Authorization:`Bearer ${a}`}:{},Accept:"*/*"},credentials:"include"});if(!u.ok)throw new Error(`HTTP ${u.status}`);const _=u.headers.get("Content-Disposition")||u.headers.get("content-disposition")||"",n=u.headers.get("Content-Type")||u.headers.get("content-type")||(s==null?void 0:s.type)||M(l,(s==null?void 0:s.name)||(s==null?void 0:s.filename))||"application/octet-stream",i=await u.blob(),d=i.type?i:new Blob([i],{type:n}),h=ce(s,l,_),b=URL.createObjectURL(d),U=document.createElement("a");U.style.display="none",U.href=b,U.download=h,document.body.appendChild(U),U.click(),setTimeout(()=>{URL.revokeObjectURL(b),U.remove()},0),c.success("Download ready"),A.value=null;return}catch(a){console.warn("downloadDocument - fetch blob method failed, falling back:",a)}try{console.log("downloadDocument - falling back to window.location"),window.location.href=l,setTimeout(()=>{A.value=null},2e3),c.info("Attempting direct download");return}catch(a){console.warn("downloadDocument - window.location failed, trying iframe:",a)}try{console.log("downloadDocument - trying iframe method");const a=document.createElement("iframe");a.style.display="none",a.src=l,document.body.appendChild(a),setTimeout(()=>{document.body.contains(a)&&document.body.removeChild(a)},5e3),c.info("Download initiated via alternative method"),A.value=null;return}catch(a){console.warn("downloadDocument - iframe method failed, last resort new tab:",a)}try{window.open(l,"_blank","noopener,noreferrer")?c.info('Document opened in new tab - use "Save As" to download'):c.warning("Please allow pop-ups and try again")}catch(a){console.error("All download methods failed:",a),c.error("Unable to download document. Please contact support.")}finally{A.value=null}},I=async()=>{try{P.value=!0,R.value="Loading...";const s=await $.getTempleApprovalCounts();s&&s.success&&s.data?(w.value={pendingApprovals:s.data.pendingApprovals||0,activeTemples:s.data.activeTemples||0,totalUsers:s.data.totalUsers||0,rejectedTemples:s.data.rejectedTemples||0,newThisWeek:s.data.newThisWeek||0},R.value="Success",B.value=new Date().toLocaleString(),c.success("Dashboard stats updated from API")):(R.value="Invalid response format",w.value.pendingApprovals===0&&(w.value={pendingApprovals:5,activeTemples:32,totalUsers:178,rejectedTemples:3,newThisWeek:4}),c.warning("Using fallback data for dashboard stats"))}catch(s){console.error("Failed to load temple counts:",s),R.value=`Error: ${s.message}`,c.error("Failed to load dashboard statistics")}finally{P.value=!1}},ge=async()=>{E.value=`Testing temple counts API...
`,N.value=!0;try{const s=[];s.push(`==== TEMPLE COUNTS API TEST ====
`),s.push("Testing direct API call to /api/v1/superadmin/temple-approval-count...");try{const e=await fetch(API_URL+"/superadmin/temple-approval-count",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(e.ok){const r=await e.json();s.push(`Direct API Response Status: ${e.status}`),s.push(`Direct API Response Data: ${JSON.stringify(r,null,2)}`)}else{s.push(`Direct API Error: ${e.status} ${e.statusText}`);const r=await e.text();s.push(`Error details: ${r}`)}}catch(e){s.push(`Direct API Error: ${e.message}`)}s.push(`
==== SERVICE METHOD TEST ====
`);try{const e=await $.getTempleApprovalCounts();s.push(`Service Response: ${JSON.stringify(e,null,2)}`),e.success&&e.data?(w.value={pendingApprovals:e.data.pendingApprovals||0,activeTemples:e.data.activeTemples||0,totalUsers:e.data.totalUsers||0,rejectedTemples:e.data.rejectedTemples||0,newThisWeek:e.data.newThisWeek||0},s.push(`Updated dashboard stats: ${JSON.stringify(w.value,null,2)}`),B.value=new Date().toLocaleString(),c.success("Stats updated from API test!")):s.push("Service method returned failure")}catch(e){s.push(`Service Error: ${e.message}`)}s.push(`
==== CURRENT STATS ====
`),s.push(`Current summaryStats: ${JSON.stringify(w.value,null,2)}`),s.push(`Last update: ${B.value||"Never"}`),s.push(`API Status: ${R.value}`),E.value=s.join(`
`)}catch(s){E.value+=`
Error running test: ${s.message}`}},J=async()=>{try{S.value=!0;const s=await $.getPendingEntities().catch(e=>(console.error("Error fetching pending entities:",e),null));s&&s.success&&s.data?(console.log("ðŸ” RAW RESPONSE DATA:",s.data),y.value=s.data.map((e,r)=>{console.log(`
========== TEMPLE ${r+1}: ${e.Name||e.name} ==========`),console.log("Documents array:",e.documents),console.log("registration_cert_url:",e.registration_cert_url),console.log("trust_deed_url:",e.trust_deed_url),console.log("property_docs_url:",e.property_docs_url),console.log("additional_docs_urls:",e.additional_docs_urls),console.log("additional_docs_info:",e.additional_docs_info),console.log("additional_docs:",e.additional_docs),console.log("additionalDocs:",e.additionalDocs),console.log(`====================================================
`);const l=(e.Status||e.status||"pending").toLowerCase(),o=e.CreatedAt||e.createdAt||e.SubmittedAt||e.submittedAt||e.created_at||e.submitted_at||new Date().toISOString();let a="";if(e.Address&&e.Address.trim())a=e.Address.trim();else if(e.address&&e.address.trim())a=e.address.trim();else{const _=[],n=e.StreetAddress||e.streetAddress||e.street_address;n&&n.trim()&&_.push(n.trim());const i=e.City||e.city;i&&i.trim()&&_.push(i.trim());const d=e.State||e.state;d&&d.trim()&&_.push(d.trim());const h=e.Pincode||e.pincode||e.PostalCode||e.postalCode||e.zipcode;h&&h.toString().trim()&&_.push(h.toString().trim()),a=_.filter(Boolean).join(", ")}const u=ae(e);return console.log(`ðŸ“„ Temple "${e.Name||e.name}" - Normalized ${u.length} documents`),{id:e.ID||e.id,templeName:e.Name||e.name,adminName:e.CreatedBy||e.createdBy||"Unknown",adminEmail:e.Email||e.email||"unknown@example.com",phone:e.Phone||e.phone,city:e.City||e.city,state:e.State||e.state,address:a||"Address not provided",status:l,submittedAt:o,approvedAt:e.ApprovedAt||e.approvedAt,rejectedAt:e.RejectedAt||e.rejectedAt,notes:e.Notes||e.notes,registrationType:e.TempleType||e.templeType,documents:u}}),console.log("âœ… Total temples loaded:",y.value.length),console.log("ðŸ“Š Document counts per temple:",y.value.map(e=>`${e.templeName}: ${e.documents.length} files`)),c.success(`Loaded ${y.value.length} temple applications`)):y.value=[]}catch(s){console.error("Failed to load pending temples:",s),c.error("Failed to load pending temple applications")}finally{S.value=!1}},G=async()=>{try{W.value=!0;try{const s=await $.getRecentActivities();if(s&&s.success&&s.data){V.value=s.data;return}}catch{}V.value=[]}catch(s){console.error("Failed to load activities:",s),c.error("Failed to load recent activities")}finally{W.value=!1}},K=async()=>{try{S.value=!0,await Promise.all([I(),J(),G()]),c.success("Data refreshed successfully")}catch(s){console.error("Error refreshing data:",s),c.error("Failed to refresh data")}finally{S.value=!1}},ve=s=>{v.value=s,T.value=!0},F=()=>{T.value=!1,v.value=null},q=async s=>{if(!x.value)try{x.value=!0,T.value&&F();try{await $.approveEntity(s.id,{notes:"Approved by super admin"})}catch{await new Promise(r=>setTimeout(r,500))}const e=y.value.findIndex(r=>r.id===s.id);e!==-1&&(y.value[e].status="approved",y.value[e].approvedAt=new Date().toISOString()),await I(),c.success(`${s.templeName} has been approved successfully!`)}catch(e){console.error("Error approving temple:",e),c.error("Failed to approve temple. Please try again.")}finally{x.value=!1}},Q=s=>{v.value=s,z.value=!0,T.value&&(T.value=!1)},X=()=>{z.value=!1,v.value=null,D.value=""},fe=async()=>{if(!D.value.trim()){c.error("Please provide a reason for rejection");return}if(!(x.value||!v.value))try{x.value=!0;const s=v.value;try{await $.rejectEntity(s.id,{notes:D.value,reason:D.value})}catch{await new Promise(r=>setTimeout(r,500))}const e=y.value.findIndex(r=>r.id===s.id);e!==-1&&(y.value[e].status="rejected",y.value[e].rejectedAt=new Date().toISOString(),y.value[e].notes=D.value),await I(),c.success(`${s.templeName} application has been rejected`),X()}catch(s){console.error("Error rejecting temple:",s),c.error("Failed to reject temple. Please try again.")}finally{x.value=!1}},he=s=>({pending:"bg-orange-100 text-orange-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",ye=s=>{if(!s)return"Not available";try{const e=new Date(s);return isNaN(e.getTime())?"Invalid date":e.toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Date unavailable"}};return we(async()=>{await I(),await Promise.all([J(),G()])}),(s,e)=>{var l;const r=_e("router-link");return p(),m("div",Te,[t("div",Ue,[t("div",$e,[t("div",Se,[e[8]||(e[8]=t("div",{class:"mb-4 sm:mb-0"},[t("h1",{class:"text-xl sm:text-2xl lg:text-3xl font-bold text-gray-900",style:{"font-family":"'Roboto', sans-serif"}}," Super Admin Dashboard "),t("p",{class:"mt-1 text-xs sm:text-sm text-gray-600"}," Manage temple registrations and system oversight ")],-1)),t("div",Re,[e[7]||(e[7]=t("div",{class:"bg-indigo-50 text-indigo-800 px-3 py-1 rounded-full text-sm font-medium"}," System Administrator ",-1)),P.value?(p(),m("div",Me,[...e[6]||(e[6]=[t("div",{class:"animate-spin rounded-full h-4 w-4 border-2 border-indigo-600 border-t-transparent mr-2"},null,-1),C(" Loading stats... ",-1)])])):k("",!0)])])])]),t("div",Le,[t("div",Ne,[te.value?(p(),m("button",{key:0,onClick:ge,class:"inline-flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg text-sm font-medium hover:bg-gray-700 transition-colors duration-200"},[...e[9]||(e[9]=[t("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1),C(" Test Counts API ",-1)])])):k("",!0),be(r,{to:"/superadmin/reports",class:"inline-flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors duration-200"},{default:ke(()=>[...e[10]||(e[10]=[t("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),C(" Reports ",-1)])]),_:1}),t("button",{onClick:K,class:"inline-flex items-center px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-50 transition-colors duration-200"},[...e[11]||(e[11]=[t("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582M20 12a8 8 0 10-15.418-3M20 12h-5"})],-1),C(" Refresh ",-1)])])]),t("div",Ee,[t("div",Ie,[t("div",Pe,[t("div",null,[e[12]||(e[12]=t("p",{class:"text-sm font-medium text-gray-600 uppercase tracking-wide"},"Pending Approvals",-1)),t("p",ze,g(w.value.pendingApprovals),1)]),e[13]||(e[13]=t("div",{class:"bg-orange-100 p-3 rounded-lg"},[t("svg",{class:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1))]),e[14]||(e[14]=t("div",{class:"mt-4"},[t("span",{class:"text-sm text-gray-500"},"Awaiting review")],-1))]),t("div",Be,[t("div",Fe,[t("div",null,[e[15]||(e[15]=t("p",{class:"text-sm font-medium text-gray-600 uppercase tracking-wide"},"Active Temples",-1)),t("p",We,g(w.value.activeTemples),1)]),e[16]||(e[16]=t("div",{class:"bg-green-100 p-3 rounded-lg"},[t("svg",{class:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2M5 21H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})])],-1))]),t("div",Ve,[t("span",He,"+"+g(w.value.newThisWeek)+" this week",1)])]),t("div",Oe,[t("div",Je,[t("div",null,[e[17]||(e[17]=t("p",{class:"text-sm font-medium text-gray-600 uppercase tracking-wide"},"Total Users",-1)),t("p",Ge,g(w.value.totalUsers),1)]),e[18]||(e[18]=t("div",{class:"bg-indigo-100 p-3 rounded-lg"},[t("svg",{class:"w-6 h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2m.356-1.857a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"})])],-1))]),e[19]||(e[19]=t("div",{class:"mt-4"},[t("span",{class:"text-sm text-gray-500"},"Across all temples")],-1))]),t("div",Ke,[t("div",qe,[t("div",null,[e[20]||(e[20]=t("p",{class:"text-sm font-medium text-gray-600 uppercase tracking-wide"},"Rejected",-1)),t("p",Qe,g(w.value.rejectedTemples),1)]),e[21]||(e[21]=t("div",{class:"bg-red-100 p-3 rounded-lg"},[t("svg",{class:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01M5.062 19h13.876c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L3.33 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1))]),e[22]||(e[22]=t("div",{class:"mt-4"},[t("span",{class:"text-sm text-gray-500"},"This month")],-1))])]),t("div",Xe,[t("div",Ye,[t("div",Ze,[e[25]||(e[25]=t("h2",{class:"text-xl font-bold text-gray-900",style:{"font-family":"'Roboto', sans-serif"}}," Pending Temple Approvals ",-1)),t("div",et,[Y(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>L.value=o),class:"text-sm border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"},[...e[23]||(e[23]=[t("option",{value:"all"},"All Status",-1),t("option",{value:"pending"},"Pending",-1),t("option",{value:"approved"},"Approved",-1),t("option",{value:"rejected"},"Rejected",-1)])],512),[[Ae,L.value]]),t("button",{onClick:K,class:"bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors duration-200"},[...e[24]||(e[24]=[t("svg",{class:"w-4 h-4 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),C(" Refresh ",-1)])])])])]),S.value?(p(),m("div",tt,[...e[26]||(e[26]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1),t("span",{class:"ml-3 text-gray-600"},"Loading temple applications...",-1)])])):(p(),m("div",st,[H.value.length===0?(p(),m("div",ot,[...e[27]||(e[27]=[t("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})],-1),t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No applications found",-1),t("p",{class:"mt-1 text-sm text-gray-500"},"No temple applications match your current filter.",-1)])])):k("",!0),(p(!0),m(Z,null,ee(H.value,o=>{var a;return p(),m("div",{key:o.id,class:"p-6 hover:bg-gray-50 transition-colors duration-200"},[t("div",nt,[t("div",rt,[t("div",lt,[t("h3",at,g(o.templeName),1),t("span",{class:je([he(o.status),"px-2 py-1 rounded-full text-xs font-medium uppercase tracking-wide"])},g(o.status),3)]),t("div",it,[t("div",null,[e[28]||(e[28]=t("p",{class:"text-sm text-gray-600"},"Email",-1)),t("p",dt,g(o.adminEmail),1)]),t("div",null,[e[29]||(e[29]=t("p",{class:"text-sm text-gray-600"},"Phone",-1)),t("p",ut,g(o.phone||"Not provided"),1)]),t("div",null,[e[30]||(e[30]=t("p",{class:"text-sm text-gray-600"},"Location",-1)),t("p",ct,g(o.city)+", "+g(o.state),1)]),t("div",null,[e[31]||(e[31]=t("p",{class:"text-sm text-gray-600"},"Submitted",-1)),t("p",mt,g(ye(o.submittedAt)),1)]),t("div",null,[e[32]||(e[32]=t("p",{class:"text-sm text-gray-600"},"Documents",-1)),t("p",pt,g(((a=o.documents)==null?void 0:a.length)||0)+" files",1)])]),o.address?(p(),m("div",gt,[e[33]||(e[33]=t("p",{class:"text-sm text-gray-600"},"Address",-1)),t("p",vt,g(o.address),1)])):k("",!0),o.notes?(p(),m("div",ft,[e[34]||(e[34]=t("p",{class:"text-sm text-gray-600"},"Admin Notes",-1)),t("div",ht,[t("p",yt,g(o.notes),1)])])):k("",!0)]),t("div",xt,[t("button",{onClick:u=>ve(o),class:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors duration-200 whitespace-nowrap"},[...e[35]||(e[35]=[t("svg",{class:"w-4 h-4 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),C(" View Details ",-1)])],8,wt),o.status==="pending"?(p(),m("div",bt,[t("button",{onClick:u=>q(o),class:"bg-green-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-green-700 transition-colors duration-200 whitespace-nowrap",disabled:x.value},[...e[36]||(e[36]=[t("svg",{class:"w-4 h-4 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),C(" Approve ",-1)])],8,kt),t("button",{onClick:u=>Q(o),class:"bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-red-700 transition-colors duration-200 whitespace-nowrap",disabled:x.value},[...e[37]||(e[37]=[t("svg",{class:"w-4 h-4 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),C(" Reject ",-1)])],8,_t)])):k("",!0)])])])}),128))]))]),T.value?(p(),m("div",At,[t("div",Ct,[t("div",{class:"px-6 py-4 border-b border-gray-200 flex items-center justify-between"},[e[39]||(e[39]=t("h3",{class:"text-lg font-bold text-gray-900"},"Temple Application Details",-1)),t("button",{onClick:F,class:"text-gray-400 hover:text-gray-600"},[...e[38]||(e[38]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",Dt,[v.value?(p(),m("div",jt,[t("div",null,[e[43]||(e[43]=t("h4",{class:"text-md font-semibold text-gray-900 mb-3"},"Temple Information",-1)),t("div",Tt,[t("div",null,[e[40]||(e[40]=t("label",{class:"text-sm text-gray-600"},"Temple Name",-1)),t("p",Ut,g(v.value.templeName),1)]),t("div",null,[e[41]||(e[41]=t("label",{class:"text-sm text-gray-600"},"Temple Type",-1)),t("p",$t,g(v.value.registrationType||"Religious Trust"),1)]),t("div",St,[e[42]||(e[42]=t("label",{class:"text-sm text-gray-600"},"Address",-1)),t("p",Rt,g(v.value.address),1)])])]),t("div",null,[e[47]||(e[47]=t("h4",{class:"text-md font-semibold text-gray-900 mb-3"},"Administrator Information",-1)),t("div",Mt,[t("div",null,[e[44]||(e[44]=t("label",{class:"text-sm text-gray-600"},"Email",-1)),t("p",Lt,g(v.value.adminEmail),1)]),t("div",null,[e[45]||(e[45]=t("label",{class:"text-sm text-gray-600"},"Phone",-1)),t("p",Nt,g(v.value.phone||"Not provided"),1)]),e[46]||(e[46]=t("div",null,[t("label",{class:"text-sm text-gray-600"},"Role"),t("p",{class:"font-medium text-gray-900"},"Temple Administrator")],-1))])]),t("div",null,[e[54]||(e[54]=t("h4",{class:"text-md font-semibold text-gray-900 mb-3"},"Uploaded Documents",-1)),!v.value.documents||v.value.documents.length===0?(p(),m("div",Et," No documents uploaded or available. ")):(p(),m("div",It,[(p(!0),m(Z,null,ee(v.value.documents,o=>(p(),m("div",{key:o.id||o.name,class:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg"},[t("div",Pt,[se(o)?(p(),m("svg",zt,[...e[48]||(e[48]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 11c0-.943 0-1.414.293-1.707C12.586 9 13.057 9 14 9h1c.943 0 1.414 0 1.707.293C17 9.586 17 10.057 17 11v2c0 .943 0 1.414-.293 1.707C16.414 15 15.943 15 15 15h-1m-4 0H9c-.943 0-1.414 0-1.707-.293C7 14.414 7 13.943 7 13v-2c0-.943 0-1.414.293-1.707C7.586 9 8.057 9 9 9h1m2 6V9m0 0V5.5c0-.465 0-.697.146-.854C12.293 4.5 12.526 4.5 12.99 4.5h1.02c.465 0 .697 0  .854.146.146.157.146.389.146.854V9"},null,-1)])])):oe(o)?(p(),m("svg",Bt,[...e[49]||(e[49]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4-4 4 4 4-4 4 4M4 8h16M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"},null,-1)])])):(p(),m("svg",Ft,[...e[50]||(e[50]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)])]))]),t("div",Wt,[t("p",Vt,g(o.name||o.filename||"document"),1),t("p",Ht,g(re(o)),1)]),t("div",Ot,[t("button",{onClick:a=>me(o),class:"px-2 py-1 text-indigo-600 hover:text-indigo-800 text-sm font-medium rounded hover:bg-indigo-50",disabled:A.value===(o.id||o.name),title:"View"},[...e[51]||(e[51]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])],8,Jt),t("button",{onClick:a=>pe(o),class:"px-2 py-1 text-gray-700 hover:text-gray-900 text-sm font-medium rounded hover:bg-gray-100",disabled:A.value===(o.id||o.name),title:"Download"},[A.value===(o.id||o.name)?(p(),m("svg",Kt,[...e[52]||(e[52]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])])):(p(),m("svg",qt,[...e[53]||(e[53]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)])]))],8,Gt)])]))),128))]))])])):k("",!0)]),t("div",Qt,[t("button",{onClick:F,class:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors duration-200"}," Close "),((l=v.value)==null?void 0:l.status)==="pending"?(p(),m("div",Xt,[t("button",{onClick:e[1]||(e[1]=o=>q(v.value)),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors duration-200",disabled:x.value}," Approve Temple ",8,Yt),t("button",{onClick:e[2]||(e[2]=o=>Q(v.value)),class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-200",disabled:x.value}," Reject Application ",8,Zt)])):k("",!0)])])])):k("",!0),z.value?(p(),m("div",es,[t("div",ts,[e[56]||(e[56]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-lg font-bold text-gray-900"},"Reject Application")],-1)),t("div",ss,[e[55]||(e[55]=t("p",{class:"text-gray-600 mb-4"},"Please provide a reason for rejecting this temple application:",-1)),Y(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=o=>D.value=o),class:"w-full h-32 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 resize-none",placeholder:"Enter rejection reason..."},null,512),[[Ce,D.value]])]),t("div",os,[t("button",{onClick:X,class:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors duration-200"}," Cancel "),t("button",{onClick:fe,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-200",disabled:x.value}," Confirm Reject ",8,ns)])])])):k("",!0),N.value?(p(),m("div",rs,[t("div",ls,[t("div",as,[e[58]||(e[58]=t("h3",{class:"text-lg font-bold text-gray-900"},"Temple Counts API Debug",-1)),t("button",{onClick:e[4]||(e[4]=o=>N.value=!1),class:"text-gray-400 hover:text-gray-600"},[...e[57]||(e[57]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("div",is,[t("div",ds,g(E.value),1)]),t("div",us,[t("button",{onClick:e[5]||(e[5]=o=>N.value=!1),class:"px-4 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded-lg"}," Close ")])])])):k("",!0)])])}}};export{gs as default};
